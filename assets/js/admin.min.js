function setCookie(e,t,a){var c=new Date;c.setTime(c.getTime()+24*a*60*60*1e3);var r="expires="+c.toUTCString();document.cookie=e+"="+t+"; "+r}function getCookie(e){for(var t=e+"=",a=document.cookie.split(";"),c=0;c<a.length;c++){for(var r=a[c];" "==r.charAt(0);)r=r.substring(1);if(0==r.indexOf(t))return r.substring(t.length,r.length)}return""}function wpsc_template_dialog(e){var t=e.name;jQuery("#wpsc_admin_templates_select_table").attr("data-editor",t),jQuery("#wpsc_templates_dialog").modal("show")}function initChosen(){jQuery(".wpsc_chosen").each(function(){jQuery(this).hasClass("wpsc_address_book_chosen")?jQuery(this).chosen({width:"100%",no_results_text:"No contacts found",placeholder_text_multiple:"Select contacts",placeholder_text_single:"Select contact"}):jQuery(this).hasClass("wpsc_attachment_chosen")?jQuery(this).chosen({width:"100%",no_results_text:"No contacts found",placeholder_text_multiple:"Select contacts",placeholder_text_single:"Select contact"}):jQuery(this).chosen({width:"100%"})})}function beforeUnload(e){for(var t in CKEDITOR.instances)if(CKEDITOR.instances[t].checkDirty())return e.returnValue="You will lose the changes made in the editor."}function doRefreshAdminTicketsTable(){if(jQuery("#wpsc_admin_tickets_table_container").length){jQuery("#wpsc_admin_tickets_table_container").html('<img src="'+wpsc_localize_admin.wpsc_plugin_url+'/assets/images/ajax-loader@2x.gif" style="vertical-align: middle;" /> Loading... Please Wait...');var e={action:"wpsc_doRefreshAdminTicketsTable"};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,e,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?(jQuery("#wpsc_admin_tickets_table_container").html(e.table),jQuery("#wpsc_admin_tickets_table").is(":visible")&&doDataTables("#wpsc_admin_tickets")):(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}}function loadAdminTicket(e,t){t&&doRefreshAdminTicketsTable(),jQuery("#wpsc_view_ticket_"+e).html('<img src="'+wpsc_localize_admin.wpsc_plugin_url+'/assets/images/ajax-loader@2x.gif" style="vertical-align: middle;" /> Loading... Please Wait...');var a={action:"wpsc_get_admin_ticket",ticket_id:e};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,a,function(a){a=jQuery.trim(a);try{if(a=jQuery.parseJSON(a),"true"==a.status&&"false"!=a.ticket){0==jQuery('li[data-id="'+e+'"]').length&&(jQuery('<li data-id="'+e+'" class="wpsc_admin_ticket_tab"><a href="#wpsc_view_ticket_'+e+'" data-toggle="tab">'+wpsc_localize_admin.wpsc_item+": "+e+' <i class="glyphicon glyphicon-remove-sign wpsc_tab_close"></i></a></li>').appendTo("#wpsc_admin_tabs"),jQuery('<div class="tab-pane" id="wpsc_view_ticket_'+e+'"></div>').appendTo("#admin-tab-content")),jQuery("#wpsc_view_ticket_"+e).html(a.ticket),doDataTables("#wpsc_view_ticket_"+e),jQuery('a[href="#wpsc_view_ticket_'+e+'"]').trigger("click"),jQuery(".wpsc_chosen").length&&initChosen(),jQuery("#wpsc_processing").modal("hide"),t&&doRefreshAdminTicketsTable();var c=[];jQuery(".wpsc_admin_ticket_tab").each(function(){c.push(jQuery(this).closest("li").attr("data-id"))});var r=c.join();setCookie("wpsc_open_tickets",r,30),setCookie("wpsc_active_ticket",e,30)}else"false"==a.status||"false"==a.ticket?(jQuery("#wpsc_quick_find").val(""),jQuery("#wpsc_processing").modal("hide"),jQuery("#wpsc_ticket_not_found").modal("show")):(console.log(a),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(s){console.log(s),jQuery("#wpsc_processing").modal("hide")}})}function loadRecurringTicket(e){jQuery("#wpsc_view_recurring_ticket_"+e).html('<img src="'+wpsc_localize_admin.wpsc_plugin_url+'/assets/images/ajax-loader@2x.gif" style="vertical-align: middle;" /> Loading... Please Wait...');var t={action:"wpsc_get_recurring_ticket",ticket_id:e};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,t,function(t){t=jQuery.trim(t);try{t=jQuery.parseJSON(t),"true"==t.status&&"false"!=t.ticket?(jQuery('<li data-id="'+e+'" class="wpsc_recurring_ticket_tab"><a href="#wpsc_view_recurring_ticket_'+e+'" data-toggle="tab">Edit Recurring '+wpsc_localize_admin.wpsc_item+' <i class="glyphicon glyphicon-remove-sign wpsc_recurring_tab_close"></i></a></li>').appendTo("#wpsc_admin_recurring_tabs"),jQuery('<div class="tab-pane" id="wpsc_view_recurring_ticket_'+e+'"></div>').appendTo(".tab-content"),jQuery("#wpsc_view_recurring_ticket_"+e).html(t.ticket),jQuery("#wpsc_edit_recurring_ticket_date_from_"+e).datepicker({minDate:0,dateFormat:"yy-mm-dd"}),jQuery("#wpsc_admin_recurring_tabs a:last").tab("show"),jQuery("#wpsc_processing").modal("hide")):(console.log(t),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(a){console.log(a),jQuery("#wpsc_processing").modal("hide")}})}function loadFrontTicket(e){var t=jQuery("#wpsc_wrap").attr("data-id");jQuery("#wpsc_front_ticket_"+e).html('<img src="'+wpsc_localize_admin.wpsc_plugin_url+'/assets/images/ajax-loader@2x.gif" style="vertical-align: middle;" /> Loading... Please Wait...');var a=[];jQuery(".wpsc_front_ticket_tab").each(function(){a.push(jQuery(this).attr("data-id"))});var c=a.join();setCookie("wpsc_open_tickets_"+t,c,30);var r={action:"wpsc_get_front_ticket",ticket_id:e};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,r,function(a){a=jQuery.trim(a);try{a=jQuery.parseJSON(a),"true"==a.status&&"false"!=a.ticket?(jQuery('<li data-id="'+e+'" class="wpsc_front_ticket_tab"><a href="#wpsc_front_ticket_'+e+'" data-toggle="tab">'+wpsc_localize_admin.wpsc_item+" #"+e+' <i class="glyphicon glyphicon-remove-sign wpsc_front_tab_close"></i></a></li>').appendTo("#wpsc_front_tabs"),jQuery('<div class="tab-pane" id="wpsc_front_ticket_'+e+'"></div>').appendTo(".tab-content"),jQuery("#wpsc_front_ticket_"+e).html(a.ticket),jQuery("#wpsc_front_tabs a:last").tab("show"),jQuery("#wpsc_processing").modal("hide"),setCookie("wpsc_active_ticket_"+t,e,30)):(console.log(a),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(c){console.log(c),jQuery("#wpsc_processing").modal("hide")}})}function getSorted(e,t){return jQuery(jQuery(e).toArray().sort(function(e,a){var c=parseInt(e.getAttribute(t)),r=parseInt(a.getAttribute(t));return c-r}))}function doDataTables(e){if("#wpsc_admin_tickets"==e)if(jQuery.fn.dataTable.isDataTable("#wpsc_admin_tickets_table"))var t=jQuery("#wpsc_admin_tickets_table").DataTable();else{var t=jQuery("#wpsc_admin_tickets_table").DataTable({dom:'<"top">rt<"bottom"lpi>',responsive:{details:{type:"column"}},columnDefs:[{className:"control",orderable:!1,width:"20px",targets:0},{orderable:!1,searchable:!1,targets:1}],order:[[10,"desc"]],autoWidth:!0});jQuery("#wpsc_admin_tickets_table tfoot th").each(function(){var e=jQuery(this).text();""!=e&&jQuery(this).html('<input type="text" placeholder="Search '+e+'" class="wpsc_datatables_search" />')}),t.columns().every(function(){var e=this;jQuery("input",this.footer()).on("keyup change",function(){e.search()!==this.value&&e.search(this.value).draw()})})}else if("#wpsc_ticket_new"==e)jQuery("#wpsc_notification_ticket_new_client").ckeditor({height:280,removeButtons:"wpsctemplates"}),jQuery("#wpsc_notification_ticket_new_admin").ckeditor({height:280,removeButtons:"wpsctemplates"});else if("#wpsc_ticket_reply"==e)jQuery("#wpsc_notification_ticket_reply_client").ckeditor({height:280,removeButtons:"wpsctemplates"}),jQuery("#wpsc_notification_ticket_reply_admin").ckeditor({height:280,removeButtons:"wpsctemplates"});else if("#wpsc_ticket_change"==e)jQuery("#wpsc_notification_ticket_change_client").ckeditor({height:280,removeButtons:"wpsctemplates"}),jQuery("#wpsc_notification_ticket_change_admin").ckeditor({height:280,removeButtons:"wpsctemplates"});else if("#wpsc_admin_new_recurring_ticket"==e)jQuery("#wpsc_new_recurring_ticket_details").ckeditor({height:280,removeButtons:"wpsctemplates"});else if("#wpsc_admin_recurring_tickets"==e)if(jQuery.fn.dataTable.isDataTable("#wpsc_admin_recurring_tickets_table"))var t=jQuery("#wpsc_admin_recurring_tickets_table").DataTable();else{var t=jQuery("#wpsc_admin_recurring_tickets_table").DataTable({columnDefs:[{orderable:!1,searchable:!1,targets:0}],order:[[8,"asc"]]});jQuery("#wpsc_admin_recurring_tickets_table tfoot th").each(function(){var e=jQuery(this).text();""!=e&&jQuery(this).html('<input type="text" placeholder="Search '+e+'" class="wpsc_datatables_search" />')}),t.columns().every(function(){var e=this;jQuery("input",this.footer()).on("keyup change",function(){e.search()!==this.value&&e.search(this.value).draw()})})}else if(e.indexOf("#wpsc_reminders_")>-1){var a=e.replace("#wpsc_reminders_","");if(jQuery.fn.dataTable.isDataTable("#wpsc_admin_reminders_table_"+a))var t=jQuery("#wpsc_admin_reminders_table_"+a).DataTable();else{var t=jQuery("#wpsc_admin_reminders_table_"+a).DataTable({columnDefs:[{orderable:!1,searchable:!1,targets:[1,3]}],order:[[2,"asc"]]});jQuery("#wpsc_admin_reminders_table_"+a+" tfoot th").each(function(){var e=jQuery(this).text();""!=e&&jQuery(this).html('<input type="text" placeholder="Search '+e+'" class="wpsc_datatables_search" />')}),t.columns().every(function(){var e=this;jQuery("input",this.footer()).on("keyup change",function(){e.search()!==this.value&&e.search(this.value).draw()})})}}else if(e.indexOf("#wpsc_participants_")>-1){var a=e.replace("#wpsc_participants_","");if(jQuery.fn.dataTable.isDataTable("#wpsc_admin_participants_table_"+a))var t=jQuery("#wpsc_admin_participants_table_"+a).DataTable();else{var t=jQuery("#wpsc_admin_participants_table_"+a).DataTable({columnDefs:[{orderable:!1,searchable:!1,targets:0}],order:[[1,"asc"]]});jQuery("#wpsc_admin_participants_table_"+a+" tfoot th").each(function(){var e=jQuery(this).text();""!=e&&jQuery(this).html('<input type="text" placeholder="Search '+e+'" class="wpsc_datatables_search" />')}),t.columns().every(function(){var e=this;jQuery("input",this.footer()).on("keyup change",function(){e.search()!==this.value&&e.search(this.value).draw()})})}}else if(e.indexOf("#wpsc_attachments_")>-1){var a=e.replace("#wpsc_attachments_","");if(jQuery.fn.dataTable.isDataTable("#wpsc_admin_attachments_table_"+a))var t=jQuery("#wpsc_admin_attachments_table_"+a).DataTable();else{var t=jQuery("#wpsc_admin_attachments_table_"+a).DataTable({columnDefs:[{orderable:!1,searchable:!1,targets:[0,2]}],order:[[1,"asc"]]});jQuery("#wpsc_admin_attachments_table_"+a+" tfoot th").each(function(){var e=jQuery(this).text();""!=e&&jQuery(this).html('<input type="text" placeholder="Search '+e+'" class="wpsc_datatables_search" />')}),t.columns().every(function(){var e=this;jQuery("input",this.footer()).on("keyup change",function(){e.search()!==this.value&&e.search(this.value).draw()})})}}else if("#wpsc_settings_status"==e)if(jQuery.fn.dataTable.isDataTable("#wpsc_admin_status"))var t=jQuery("#wpsc_admin_status").DataTable();else{var t=jQuery("#wpsc_admin_status").DataTable({columnDefs:[{orderable:!1,searchable:!1,width:"10%",targets:0},{orderable:!1,searchable:!1,width:"20%",targets:3},{orderable:!1,searchable:!1,width:"20%",targets:4}],order:[[1,"asc"]],autoWidth:!1});jQuery("#wpsc_admin_status tfoot th").each(function(){var e=jQuery(this).text();""!=e&&jQuery(this).html('<input type="text" placeholder="Search '+e+'" class="wpsc_datatables_search" />')}),t.columns().every(function(){var e=this;jQuery("input",this.footer()).on("keyup change",function(){e.search()!==this.value&&e.search(this.value).draw()})}),jQuery("#wpsc_admin_status").on("click","tbody td.wpsc_editable_status",function(e){var t=jQuery(this).attr("data-id");jQuery("#wpsc_text_status_"+t).hide(),jQuery("#save_status_"+t).show(),jQuery("#wpsc_status_"+t).show().focus()}),jQuery("#wpsc_admin_status").on("blur","tbody td.wpsc_editable_status",function(e){var t=jQuery(this).attr("data-id"),a=jQuery("#wpsc_status_"+t).val();jQuery("#wpsc_text_status_"+t).html(a),jQuery("#wpsc_text_status_"+t).show(),jQuery("#wpsc_status_"+t).hide()}),jQuery("#wpsc_admin_status").on("click","tbody td.wpsc_editable_prefix",function(e){var t=jQuery(this).attr("data-id");jQuery("#wpsc_text_prefix_"+t).hide(),jQuery("#save_status_"+t).show(),jQuery("#wpsc_prefix_"+t).show().focus()}),jQuery("#wpsc_admin_status").on("blur","tbody td.wpsc_editable_prefix",function(e){var t=jQuery(this).attr("data-id"),a=jQuery("#wpsc_prefix_"+t).val();jQuery("#wpsc_text_prefix_"+t).html(a),jQuery("#wpsc_text_prefix_"+t).show(),jQuery("#wpsc_prefix_"+t).hide()})}else if("#wpsc_settings_category"==e)if(jQuery.fn.dataTable.isDataTable("#wpsc_admin_category"))var t=jQuery("#wpsc_admin_category").DataTable();else{var t=jQuery("#wpsc_admin_category").DataTable({columnDefs:[{orderable:!1,searchable:!1,width:"5%",targets:0},{orderable:!1,searchable:!1,width:"10%",targets:1},{orderable:!1,searchable:!1,width:"20%",targets:3}],order:[[2,"asc"]],autoWidth:!1});jQuery("#wpsc_admin_category tfoot th").each(function(){var e=jQuery(this).text();""!=e&&jQuery(this).html('<input type="text" placeholder="Search '+e+'" class="wpsc_datatables_search" />')}),t.columns().every(function(){var e=this;jQuery("input",this.footer()).on("keyup change",function(){e.search()!==this.value&&e.search(this.value).draw()})})}else if("#wpsc_settings_priority"==e)if(jQuery.fn.dataTable.isDataTable("#wpsc_admin_priority"))var t=jQuery("#wpsc_admin_priority").DataTable();else{var t=jQuery("#wpsc_admin_priority").DataTable({columnDefs:[{orderable:!1,searchable:!1,width:"10%",targets:0},{orderable:!1,searchable:!1,width:"20%",targets:2},{orderable:!1,searchable:!1,width:"20%",targets:3},{orderable:!1,searchable:!1,width:"20%",targets:4}],order:[[1,"asc"]],autoWidth:!1});jQuery("#wpsc_admin_priority tfoot th").each(function(){var e=jQuery(this).text();""!=e&&jQuery(this).html('<input type="text" placeholder="Search '+e+'" class="wpsc_datatables_search" />')}),t.columns().every(function(){var e=this;jQuery("input",this.footer()).on("keyup change",function(){e.search()!==this.value&&e.search(this.value).draw()})}),jQuery("#wpsc_admin_priority").on("click","tbody td.wpsc_editable_priority",function(e){var t=jQuery(this).attr("data-id");jQuery("#wpsc_text_priority_"+t).hide(),jQuery("#save_priority_"+t).show(),jQuery("#wpsc_priority_"+t).show().focus()}),jQuery("#wpsc_admin_priority").on("blur","tbody td.wpsc_editable_priority",function(e){var t=jQuery(this).attr("data-id"),a=jQuery("#wpsc_priority_"+t).val();jQuery("#wpsc_text_priority_"+t).html(a),jQuery("#wpsc_text_priority_"+t).show(),jQuery("#wpsc_priority_"+t).hide()}),jQuery("#wpsc_admin_priority").on("click","tbody td.wpsc_editable_sla",function(e){var t=jQuery(this).attr("data-id");jQuery("#wpsc_text_sla_"+t).hide(),jQuery("#save_priority_"+t).show(),jQuery("#wpsc_sla_"+t).show().focus()}),jQuery("#wpsc_admin_priority").on("blur","tbody td.wpsc_editable_sla",function(e){var t=jQuery(this).attr("data-id"),a=jQuery("#wpsc_sla_"+t).val();jQuery("#wpsc_text_sla_"+t).html(a),jQuery("#wpsc_text_sla_"+t).show(),jQuery("#wpsc_sla_"+t).hide()})}else if("#wpsc_settings_agent"==e)if(jQuery.fn.dataTable.isDataTable("#wpsc_admin_users_table"))var t=jQuery("#wpsc_admin_users_table").DataTable();else{var t=jQuery("#wpsc_admin_users_table").DataTable({aoColumnDefs:[{sWidth:"30%",aTargets:[0]},{sWidth:"50%",aTargets:[1]},{sWidth:"10%",iDataSort:3,aTargets:[2]},{bVisible:!1,bSearchable:!1,targets:[3]},{sWidth:"10%",iDataSort:5,aTargets:[4]},{bVisible:!1,bSearchable:!1,targets:[5]}],order:[[4,"asc"],[2,"asc"],[0,"asc"],[1,"asc"]],autoWidth:!1});jQuery("#wpsc_admin_users_table tfoot th").each(function(){var e=jQuery(this).text();""!=e&&jQuery(this).html('<input type="text" placeholder="Search '+e+'" class="wpsc_datatables_search" />')}),t.columns().every(function(){var e=this;jQuery("input",this.footer()).on("keyup change",function(){e.search()!==this.value&&e.search(this.value).draw()})})}else if("#wpsc_admin_templates"==e)if(jQuery.fn.dataTable.isDataTable("#wpsc_admin_templates_table"))var t=jQuery("#wpsc_admin_templates_table").DataTable();else{var t=jQuery("#wpsc_admin_templates_table").DataTable({columnDefs:[{orderable:!1,searchable:!1,width:"10%",targets:0},{orderable:!1,searchable:!1,width:"10%",targets:2}],order:[[1,"asc"]],autoWidth:!1,oLanguage:{oPaginate:{sFirst:"<<",sPrevious:"<",sNext:">",sLast:">>"},sInfo:"_START_ to _END_ (_TOTAL_)",sInfoEmpty:"0 Found",sInfoFiltered:" [_MAX_]"}});jQuery("#wpsc_admin_templates_table tfoot th").each(function(){var e=jQuery(this).text();""!=e&&jQuery(this).html('<input type="text" placeholder="Search '+e+'" class="wpsc_datatables_search" />')}),t.columns().every(function(){var e=this;jQuery("input",this.footer()).on("keyup change",function(){e.search()!==this.value&&e.search(this.value).draw()})})}else if("#wpsc_admin_piping_catch_all"==e||"#wpsc_mailbox"==e)if(jQuery.fn.dataTable.isDataTable("#wpsc_admin_email_piping_preview"))var t=jQuery("#wpsc_admin_email_piping_preview").DataTable();else{var t=jQuery("#wpsc_admin_email_piping_preview").DataTable({columnDefs:[{orderable:!1,searchable:!1,targets:3}],order:[[2,"desc"]],autoWidth:!1});jQuery("#wpsc_admin_email_piping_preview tfoot th").each(function(){var e=jQuery(this).text();""!=e&&jQuery(this).html('<input type="text" placeholder="Search '+e+'" class="wpsc_datatables_search" />')}),t.columns().every(function(){var e=this;jQuery("input",this.footer()).on("keyup change",function(){e.search()!==this.value&&e.search(this.value).draw()})})}else if(e.indexOf("#wpsc_view_ticket_")>-1){var a=e.replace("#wpsc_view_ticket_","");jQuery("#wpsc_admin_ticket_note_"+a).ckeditor({height:280})}else if(e.indexOf("#wpsc_account_")>-1){var a=e.replace("#wpsc_account_","");jQuery("#wpsc_account_information_"+a).ckeditor({height:280,removeButtons:"wpsctemplates"})}else if("#wpsc_admin_new_ticket"==e)jQuery("#wpsc_admin_new_ticket_details").ckeditor({height:280});else if("#wpsc_front_new_ticket"==e)jQuery("#wpsc_front_new_ticket_details").ckeditor({height:280,removeButtons:"wpsctemplates"});else if(e.indexOf("#wpsc_view_recurring_ticket_")>-1){var a=e.replace("#wpsc_view_recurring_ticket_","");jQuery("#wpsc_edit_recurring_ticket_details_"+a).ckeditor({height:280})}else if("#wpsc_front_tickets"==e||"#wpsc_front_datatable"==e)if(jQuery.fn.dataTable.isDataTable("#wpsc_front_tickets_table"))var t=jQuery("#wpsc_front_tickets_table").DataTable();else{var t=jQuery("#wpsc_front_tickets_table").DataTable({responsive:{details:{type:"column"}},columnDefs:[{className:"control",orderable:!1,width:"20px",targets:0},{width:"10%",targets:1},{width:"25%",targets:3},{width:"20%",targets:5},{width:"20%",targets:7}],order:[[7,"desc"]],autoWidth:!1});jQuery("#wpsc_front_tickets_table tfoot th").each(function(){var e=jQuery(this).text();""!=e&&jQuery(this).html('<input type="text" placeholder="Search '+e+'" class="wpsc_datatables_search" />')}),t.columns().every(function(){var e=this;jQuery("input",this.footer()).on("keyup change",function(){e.search()!==this.value&&e.search(this.value).draw()})})}else if(e.indexOf("#wpsc_front_ticket_")>-1){var a=e.replace("#wpsc_front_ticket_","");jQuery("#wpsc_front_ticket_note_"+a).ckeditor({height:280,removeButtons:"wpsctemplates"})}else if("#wpsc_admin_new_template"==e)jQuery("#wpsc_new_template").ckeditor({height:280,removeButtons:"wpsctemplates"});else if("#wpsc_settings_email"==e)if(jQuery("#wpsc_admin_signature").ckeditor({height:280,removeButtons:"wpsctemplates"}),jQuery.fn.dataTable.isDataTable("#wpsc_admin_imap_accounts"))var t=jQuery("#wpsc_admin_imap_accounts").DataTable();else{var t=jQuery("#wpsc_admin_imap_accounts").DataTable({columnDefs:[{width:"18%",targets:[0,4]},{width:"10%",targets:1},{orderable:!1,searchable:!1,width:"18%",targets:3},{width:"10%",targets:5}],autoWidth:!1});jQuery("#wpsc_admin_imap_accounts tfoot th").each(function(){var e=jQuery(this).text();""!=e&&jQuery(this).html('<input type="text" placeholder="Search '+e+'" class="wpsc_datatables_search" />')}),t.columns().every(function(){var e=this;jQuery("input",this.footer()).on("keyup change",function(){e.search()!==this.value&&e.search(this.value).draw()})})}}var editorID;CKEDITOR.on("instanceReady",function(e){var t=e.editor,a=t.name;if(-1==a.indexOf("_front_")){var c=new CKEDITOR.command(t,{exec:function(e){return tb_show("Upload a file","media-upload.php?TB_iframe=true&post_id=0",!1),editorID=a,!1}});e.editor.commands.image.exec=c.exec}}),window.addEventListener?window.addEventListener("beforeunload",beforeUnload,!1):window.attachEvent("onbeforeunload",beforeUnload),window.send_to_editor=function(e){jQuery("img",e).attr("src");CKEDITOR.instances[editorID].insertHtml(e),tb_remove()},jQuery(document).ready(function(){jQuery(this).attr("title");jQuery(".wpsc-bootstrap-alert").removeClass("hidden"),jQuery(document).on("change","input[name=wpsc_email_method]",function(){var e=jQuery("input[name=wpsc_email_method]:checked").val();"0"==e?(jQuery("#wpsc_email_method_piping_settings").hide(),jQuery("#wpsc_email_method_imap_settings").hide()):"1"==e?(jQuery("#wpsc_email_method_piping_settings").show(),jQuery("#wpsc_email_method_imap_settings").hide()):"2"==e&&(jQuery("#wpsc_email_method_piping_settings").hide(),jQuery("#wpsc_email_method_imap_settings").show())}),jQuery(document).on("change","#wpsc_front_new_ticket_category",function(){jQuery(this).val()}),jQuery(window).resize(function(){jQuery.fn.dataTable.tables({visible:!0,api:!0}).columns.adjust().draw()}),jQuery(".wpsc_colour_picker").each(function(){jQuery(this).wpColorPicker({change:function(e,t){var a=jQuery(this).attr("data-id"),c=jQuery(this).attr("data-type");jQuery("#save_"+c+"_"+a).show()}})}),jQuery(":input").keypress(function(e){if(13===e.which){e.preventDefault();var t=jQuery(":focus"),a=t.closest("form ").attr("id");"wpsc_quick_find_form"==a&&jQuery("#wpsc_quick_find_button").click()}}),jQuery(document).on("click",".wpsc_tickets_refresh",function(){document.location.href=document.location.href}),initChosen(),"true"!=wpsc_localize_admin.wpsc_is_agent&&"true"!=wpsc_localize_admin.wpsc_is_super||"wp-support-centre"!=wpsc_localize_admin.wpsc_page||setInterval(function(){"Notification"in window?(data={action:"wpsc_get_notifications"},jQuery.post(wpsc_localize_admin.wpsc_ajax_url,data,function(e){e=jQuery.trim(e);try{if(e=jQuery.parseJSON(e),"true"==e.status){var t=e.wpscNew,a=e.wpscReply,c=(e.wpscSLA,wpsc_localize_admin.wpsc_plugin_url+"/assets/images/support-centre-60x60.png");if(""!=t){var r=t.split(",");jQuery.each(r,function(e,t){var a=(new Date).toLocaleString(wpsc_localize_admin.wpsc_locale),r="New Ticket ("+a+")",s="A new ticket has been submitted: "+t,i={tag:"wpscNew"+t,body:s,icon:c,requireInteraction:!0};Notification.requestPermission(function(){var e=new Notification(r,i);e.onclick=function(){var t=e.tag,a=t.replace("wpscNew","");0==jQuery("#wpsc_view_ticket_"+a).length?(jQuery("#wpsc_processing").modal("show"),loadAdminTicket(a,!1)):jQuery('a[href="#wpsc_view_ticket_'+a+'"]').trigger("click"),window.focus(),e.close()}})})}if(""!=a){var r=a.split(",");jQuery.each(r,function(e,t){var a=(new Date).toLocaleString(wpsc_localize_admin.wpsc_locale),r="New Reply ("+a+")",s="A new reply has been submitted for ticket: "+t,i={tag:"wpscReply"+t,body:s,icon:c,requireInteraction:!0};Notification.requestPermission(function(){var e=new Notification(r,i);e.onclick=function(){var t=e.tag,a=t.replace("wpscReply","");0==jQuery("#wpsc_view_ticket_"+a).length?(jQuery("#wpsc_processing").modal("show"),loadAdminTicket(a,!1)):jQuery('a[href="#wpsc_view_ticket_'+a+'"]').trigger("click"),window.focus(),e.close()}})})}if(""!=t||""!=a)doRefreshAdminTicketsTable();else{var s=jQuery.parseJSON(e.wpscUpdated);jQuery(s).each(function(){var e=jQuery(this).attr("id"),t=jQuery(this).attr("background"),a=jQuery(this).attr("text");jQuery("#wpsc_ticket_updated_"+e).attr("style",function(e,c){return"background-color:"+t+" !important;color:"+a+" !important;"})});var i=jQuery.parseJSON(e.wpscReminders);jQuery(i).each(function(){var e=jQuery(this).attr("ticket_id"),t=(new Date).toLocaleString(wpsc_localize_admin.wpsc_locale),a="Attention Required ("+t+")",r=jQuery(this).attr("subject"),s={tag:"wpscReminder"+e,body:r,icon:c,requireInteraction:!0};Notification.requestPermission(function(){var e=new Notification(a,s);e.onclick=function(t){var a=e.tag,c=a.replace("wpscReminder","");0==jQuery("#wpsc_view_ticket_"+c).length?(jQuery("#wpsc_processing").modal("show"),loadAdminTicket(c,!1)):jQuery('a[href="#wpsc_view_ticket_'+c+'"]').trigger("click"),window.focus(),e.close()}})})}}else console.log(e)}catch(_){console.log(_)}})):console.log("Notifications not supported")},3e4),jQuery(document).on("click",".wpsc_template_insert_row",function(){var e=jQuery("#wpsc_admin_templates_select_table").attr("data-editor"),t=jQuery(this).attr("data-id"),a=e.replace("wpsc_admin_ticket_note_","");jQuery("#wpsc_processing").modal("show"),jQuery("#wpsc_templates_dialog").modal("hide"),data={action:"wpsc_get_template",template_id:t,ticket_id:a},jQuery.post(wpsc_localize_admin.wpsc_ajax_url,data,function(t){jQuery("#wpsc_processing").modal("hide"),t=jQuery.trim(t);try{t=jQuery.parseJSON(t),"true"==t.status?CKEDITOR.instances[e].insertHtml(t.template):(console.log(t),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(a){console.log(a),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click","#wpsc_admin_open_selected",function(){jQuery("#wpsc_processing").modal("show"),jQuery(".wpsc_select_ticket").each(function(){if(jQuery(this).is(":checked")){var e=jQuery(this).val();loadAdminTicket(e,!1)}})}),jQuery("#wpsc_admin_client_autocomplete_recurring").autocomplete({source:function(e,t){jQuery.getJSON(wpsc_localize_admin.wpsc_ajax_url+"?action=wpsc_registered_users_search",e,t)},change:function(e,t){t.item?(jQuery("#wpsc_new_recurring_ticket_client_id").val(t.item.id),jQuery("#wpsc_new_recurring_ticket_client_email").val(t.item.email).attr("readonly",!0),jQuery("#wpsc_new_recurring_ticket_client_phone").val(t.item.phone)):(jQuery("#wpsc_new_recurring_ticket_client_id").val("0"),jQuery("#wpsc_new_recurring_ticket_client_email").val("").attr("readonly",!1),jQuery("#wpsc_new_recurring_ticket_client_phone").val(""))},minLength:3}),jQuery("#wpsc_admin_client_autocomplete").autocomplete({source:function(e,t){jQuery.getJSON(wpsc_localize_admin.wpsc_ajax_url+"?action=wpsc_registered_users_search",e,t)},change:function(e,t){if(t.item)jQuery("#wpsc_admin_new_ticket_client_id").val(t.item.id),jQuery("#wpsc_admin_new_ticket_client").val(t.item.value),jQuery("#wpsc_admin_new_ticket_client_email").val(t.item.email),jQuery("#wpsc_admin_new_ticket_phone").val(t.item.phone),jQuery("#wpsc_admin_new_ticket_to").val(t.item.email).removeClass("wpsc_admin_new_ticket_validate"),jQuery("#wpsc_admin_new_ticket_to_required").hide();else{var a=jQuery(this).val(),c=jQuery("#wpsc_admin_new_ticket_to").val();jQuery("#wpsc_admin_new_ticket_client_id").val("0"),jQuery("#wpsc_admin_new_ticket_client").val(a),jQuery("#wpsc_admin_new_ticket_client_email").val(c),jQuery("#wpsc_admin_new_ticket_phone").val(""),jQuery("#wpsc_admin_new_ticket_to_required").show(),jQuery("#wpsc_admin_new_ticket_to").val("").addClass("wpsc_admin_new_ticket_validate")}},minLength:3}),jQuery("#wpsc_admin_new_ticket_client_email").autocomplete({source:function(e,t){jQuery.getJSON(wpsc_localize_admin.wpsc_ajax_url+"?action=wpsc_registered_users_search",e,t)},change:function(e,t){if(t.item)jQuery("#wpsc_admin_new_ticket_client_id").val(t.item.id),jQuery("#wpsc_admin_new_ticket_client").val(t.item.value),jQuery("#wpsc_admin_client_autocomplete").val(t.item.value),jQuery("#wpsc_admin_new_ticket_client_email").val(t.item.email),jQuery("#wpsc_admin_new_ticket_phone").val(t.item.phone),jQuery("#wpsc_admin_new_ticket_to").val(t.item.email).removeClass("wpsc_admin_new_ticket_validate"),jQuery("#wpsc_admin_new_ticket_to_required").hide();else{var a=jQuery(this).val(),c=jQuery("#wpsc_admin_client_autocomplete").val();jQuery("#wpsc_admin_new_ticket_client_id").val("0"),jQuery("#wpsc_admin_new_ticket_client").val(c),jQuery("#wpsc_admin_new_ticket_client_email").val(a),jQuery("#wpsc_admin_new_ticket_phone").val(""),jQuery("#wpsc_admin_new_ticket_to_required").show(),jQuery("#wpsc_admin_new_ticket_to").val(a).addClass("wpsc_admin_new_ticket_validate")}},minLength:3}),jQuery("#wpsc_ticket_filter_client").autocomplete({source:function(e,t){jQuery.getJSON(wpsc_localize_admin.wpsc_ajax_url+"?action=wpsc_registered_users_search",e,t)},select:function(e,t){jQuery("#wpsc_ticket_filter_client_id").val(t.item.id)},minLength:3}),jQuery("#wpsc_recurring_ticket_date_from").datepicker({minDate:0,dateFormat:"yy-mm-dd"}),jQuery("#wpsc_ticket_filter_date_from").datepicker({maxDate:0,dateFormat:"yy-mm-dd",onSelect:function(e){jQuery("#wpsc_ticket_filter_date_to").datepicker("option","minDate",e),(null==jQuery("#wpsc_ticket_filter_date_to").datepicker("getDate")||""==jQuery("#wpsc_ticket_filter_date_to").datepicker("getDate"))&&jQuery("#wpsc_ticket_filter_date_to").datepicker("setDate",new Date)}}),jQuery("#wpsc_ticket_filter_date_to").datepicker({maxDate:0,dateFormat:"yy-mm-dd",onSelect:function(e){jQuery("#wpsc_ticket_filter_date_from").datepicker("option","maxDate",e),(null==jQuery("#wpsc_ticket_filter_date_from").datepicker("getDate")||""==jQuery("#wpsc_ticket_filter_date_from").datepicker("getDate"))&&jQuery("#wpsc_ticket_filter_date_from").datepicker("setDate",jQuery("#wpsc_ticket_filter_date_to").datepicker("getDate"))}}),""!=jQuery("#wpsc_ticket_filter_date_from").val()&&jQuery("#wpsc_ticket_filter_date_to").datepicker("option","minDate",jQuery("#wpsc_ticket_filter_date_from").datepicker("getDate")),""!=jQuery("#wpsc_ticket_filter_date_to").val()&&jQuery("#wpsc_ticket_filter_date_from").datepicker("option","maxDate",jQuery("#wpsc_ticket_filter_date_to").datepicker("getDate")),jQuery(document).on("click","#wpsc_select_all",function(){jQuery(this).is(":checked")?(jQuery(".wpsc_select_ticket").prop("checked",!0),jQuery("#wpsc_ticket_actions").show()):(jQuery(".wpsc_select_ticket").prop("checked",!1),jQuery("#wpsc_ticket_actions").hide())}),jQuery(document).on("click",".wpsc_select_ticket",function(){jQuery(this).is(":checked")&&jQuery(".wpsc_select_ticket").length==jQuery(".wpsc_select_ticket:checked").length?jQuery("#wpsc_select_all").prop("checked",!0):jQuery("#wpsc_select_all").prop("checked",!1),0==jQuery(".wpsc_select_ticket:checked").length?jQuery("#wpsc_ticket_actions").hide():jQuery("#wpsc_ticket_actions").show()}),jQuery(document).on("click","#wpsc_admin_apply_actions",function(e){var t="";jQuery(".wpsc_select_ticket:checked").each(function(){var e=jQuery(this).val();t="undefined"==t||""==t?e:t+","+e});var a=jQuery("#wpsc_ticket_action_status").val(),c=jQuery("#wpsc_ticket_action_category").val(),r=jQuery("#wpsc_ticket_action_agent").val(),s=jQuery("#wpsc_ticket_action_priority").val();if(""==a&&""==c&&""==r&&""==s)return!1;jQuery("#wpsc_processing").modal("show");var i={action:"wpsc_admin_apply_actions",theSelectedIDs:t,wpsc_ticket_action_status:a,wpsc_ticket_action_category:c,wpsc_ticket_action_agent:r,wpsc_ticket_action_priority:s};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,i,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?document.location.href=document.location.href:(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click","#wpsc_admin_apply_filter",function(e){var t=!1;return jQuery(".wpsc_ticket_filter").each(function(){""!=jQuery(this).val()&&(t=!0)}),!1===t?!1:""!=jQuery("#wpsc_ticket_filter_date_from").val()&&""==jQuery("#wpsc_ticket_filter_date_to").val()?(jQuery("#wpsc_ticket_filter_date_to").addClass("wpsc_field_error"),!1):""!=jQuery("#wpsc_ticket_filter_date_to").val()&&""==jQuery("#wpsc_ticket_filter_date_from").val()?(jQuery("#wpsc_ticket_filter_date_from").addClass("wpsc_field_error"),
!1):(jQuery("#wpsc_processing").modal("show"),void jQuery("#wpsc_filter_form").submit())}),jQuery(document).on("click","#wpsc_admin_clear_filter",function(e){jQuery(".wpsc_ticket_filter").val(""),jQuery("#wpsc_processing").modal("show"),jQuery("#wpsc_filter_form").submit()}),jQuery(document).on("click","#wpsc_admin_search_button",function(e){jQuery("#wpsc_processing").modal("show"),jQuery(this).closest("form").submit()}),jQuery(document).on("click","#wpsc_admin_clear_search",function(e){jQuery("#wpsc_processing").modal("show"),document.location.href=document.location.href}),jQuery(document).on("click",".wpsc_admin_ticket_row td",function(){if(!1===jQuery(this).hasClass("wpsc_select_ticket_td")){var e=jQuery(this).closest("tr").attr("data-id");0==jQuery("#wpsc_view_ticket_"+e).length?(jQuery("#wpsc_processing").modal("show"),loadAdminTicket(e,!1)):jQuery('a[href="#wpsc_view_ticket_'+e+'"]').trigger("click")}}),jQuery(document).on("click",".wpsc_user_row td",function(){if(!1===jQuery(this).hasClass("wpsc_user_agent_td")&&!1===jQuery(this).hasClass("wpsc_user_supervisor_td")){var e=jQuery(this).closest("tr").attr("data-user-id"),t=jQuery(this).closest("tr").attr("data-display-name");if(0==jQuery("#wpsc_view_user_"+e).length){var a={action:"wpsc_get_user_data",user_id:e,display_name:t};jQuery("#wpsc_processing").modal("show"),jQuery.post(wpsc_localize_admin.wpsc_ajax_url,a,function(a){a=jQuery.trim(a);try{a=jQuery.parseJSON(a),"true"==a.status?(jQuery('<li data-id="'+e+'" class="wpsc_admin_user_tab" id="wpsc_account_tab_'+e+'"><a href="#wpsc_account_'+e+'" data-toggle="tab">'+t+" ("+e+') <i class="glyphicon glyphicon-remove-sign wpsc_user_tab_close"></i></a></li>').appendTo("#wpsc_admin_settings_users_tabs"),jQuery(a.content).appendTo("#wpsc_users_content"),jQuery("#wpsc_admin_settings_users_tabs a:last").tab("show"),jQuery("#wpsc_account_information_"+e).ckeditor({height:280,removeButtons:"wpsctemplates"}),jQuery("#wpsc_processing").modal("hide")):(console.log(a),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(c){console.log(c),jQuery("#wpsc_processing").modal("hide")}})}}}),jQuery(document).on("click",".wpsc_tab_close",function(){var e=jQuery(this).closest("li").attr("data-id"),t=CKEDITOR.instances["wpsc_admin_ticket_note_"+e];if(t&&t.checkDirty()){var a=confirm("You will lose the changes made in the editor.");if(1!=a)return}var c=CKEDITOR.instances["wpsc_account_information_"+e];if(c&&c.checkDirty()){var a=confirm("You will lose the changes made in the editor.");if(1!=a)return}t&&(t.resetDirty(),t.destroy()),c&&(c.resetDirty(),c.destroy()),jQuery(this).closest("li").remove(),jQuery("#wpsc_view_ticket_"+e).remove();var r=[];jQuery(".wpsc_admin_ticket_tab").each(function(){r.push(jQuery(this).closest("li").attr("data-id"))});var s=r.join();setCookie("wpsc_open_tickets",s,30),setCookie("wpsc_active_ticket","",30),jQuery("#wpsc_admin_tabs a:first").tab("show")}),jQuery(document).on("click",".wpsc_user_tab_close",function(){var e=jQuery(this).closest("li").remove().attr("data-id");jQuery("#wpsc_account_"+e).remove(),jQuery("#wpsc_admin_settings_users_tabs a:first").tab("show")}),jQuery(document).on("change","#wpsc_admin_new_ticket_to",function(){var e=jQuery(this).val();jQuery("#wpsc_admin_new_ticket_client_email").val(e),jQuery("#wpsc_admin_new_ticket_client_id").val("0"),jQuery("#wpsc_admin_new_ticket_to_required").show(),jQuery("#wpsc_admin_new_ticket_to").addClass("wpsc_admin_new_ticket_validate")}),jQuery(document).on("click",".glyphicon-new-window",function(){var e=jQuery(this).attr("data-id"),t=jQuery(this).attr("data-client"),a={action:"wpsc_new_ticket_from_thread",thread_id:e,client_id:t};jQuery("#wpsc_processing").modal("show"),jQuery.post(wpsc_localize_admin.wpsc_ajax_url,a,function(e){e=jQuery.trim(e);try{if(e=jQuery.parseJSON(e),"true"==e.status){jQuery('.nav-tabs a[href="#wpsc_admin_new_ticket"').tab("show"),jQuery("#wpsc_admin_client_autocomplete").val(e.client),jQuery("#wpsc_admin_new_ticket_client").val(e.client),jQuery("#wpsc_admin_new_ticket_client_email").val(e.client_email),jQuery("#wpsc_admin_new_ticket_to").val(e.client_email),jQuery("#wpsc_admin_new_ticket_client_id").val(t);var a=CKEDITOR.instances.wpsc_admin_new_ticket_details;a?CKEDITOR.instances.wpsc_admin_new_ticket_details.setData(e.thread):jQuery("#wpsc_admin_new_ticket_details").val(e.thread),jQuery("#wpsc_admin_new_ticket_subject").focus(),jQuery("#wpsc_processing").modal("hide")}else console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide")}catch(c){console.log(c),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".glyphicon-share-alt",function(){var e=jQuery(this).attr("data-thread_id"),t=prompt("Please enter the ticket number to copy this thread to","");if(null!=t){var a={action:"wpsc_copy_thread_to_ticket",thread_id:e,ticket_id:t};jQuery("#wpsc_processing").modal("show"),jQuery.post(wpsc_localize_admin.wpsc_ajax_url,a,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?document.location.href=document.location.href:(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}}),jQuery(document).on("click",".glyphicon-envelope",function(){var e=confirm("Press OK to resend notifications.");if(1==e){var t=jQuery(this).attr("data-ticket-id"),a=jQuery(this).attr("data-thread_id"),c={action:"wpsc_resend_thread_notifications",ticket_id:t,thread_id:a};jQuery("#wpsc_processing").modal("show"),jQuery.post(wpsc_localize_admin.wpsc_ajax_url,c,function(e){e=jQuery.trim(e);try{if(e=jQuery.parseJSON(e),"true"==e.status){if("true"==e.client&&"true"==e.admin)var t=wpsc_localize_admin.wpsc_client+" and admin.";else if("true"==e.client)var t=wpsc_localize_admin.wpsc_client+".";else if("true"==e.admin)var t="admin.";jQuery("#wpsc_thread_resend_message").html(t),jQuery("#wpsc_thread_notifications_sent_dialog").modal("show"),jQuery("#wpsc_processing").modal("hide")}else console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide")}catch(a){console.log(a),jQuery("#wpsc_processing").modal("hide")}})}}),jQuery(document).on("click",".wpsc_admin_new_ticket_button",function(e){e.preventDefault();var t=jQuery(this).attr("id"),a=!0;if(jQuery(".wpsc_field_error").removeClass("wpsc_field_error"),jQuery(".wpsc_admin_new_ticket_validate").each(function(){if(""==jQuery(this).val())"wpsc_admin_new_ticket_client_id"==jQuery(this).attr("id")||"wpsc_admin_new_ticket_client"==jQuery(this).attr("id")||"wpsc_admin_new_ticket_client_email"==jQuery(this).attr("id")?jQuery("#wpsc_admin_client_autocomplete").addClass("wpsc_field_error"):jQuery(this).addClass("wpsc_field_error"),a=!1;else if("wpsc_admin_new_ticket_client"==jQuery(this).attr("id")){var e=jQuery(this).val();-1==e.indexOf(" ")&&(jQuery("#wpsc_admin_client_autocomplete").addClass("wpsc_field_error"),a=!1)}}),jQuery(".wpsc_additional_field_required").each(function(){var e=jQuery(this).attr("data-ticket-id");(isNaN(e)||""==e)&&jQuery(this).is(":visible")&&""==jQuery(this).val()&&(jQuery(this).addClass("wpsc_field_error"),a=!1)}),a!==!1){jQuery("#wpsc_processing").modal("show");var c=new FormData;c.append("action","wpsc_admin_new_ticket_save"),c.append("action_type",t),jQuery(".wpsc_new_ticket").each(function(){var e=jQuery(this).attr("id"),t=jQuery(this).val();c.append(e,t)});var r=CKEDITOR.instances.wpsc_admin_new_ticket_details.getData();c.append("wpsc_admin_new_ticket_details",r);var s=jQuery("#wpsc_admin_new_ticket_attachments").prop("files");jQuery.each(s,function(e,t){c.append("wpsc_file["+e+"]",t)});var i=0,_=[];if(jQuery(".wpsc_additional_field").length){jQuery(".wpsc_additional_field").each(function(){if(jQuery(this).is(":visible")){var e=jQuery(this).attr("data-ticket-id");(isNaN(e)||""==e)&&(_[i]={},_[i].field_id=jQuery(this).attr("id"),_[i].meta_value=jQuery(this).val(),i+=1)}});var n=JSON.stringify(_);c.append("wpsc_additional_field",n)}CKEDITOR.instances.wpsc_admin_new_ticket_details.resetDirty(),jQuery.ajax({url:wpsc_localize_admin.wpsc_ajax_url,type:"POST",data:c,async:!0,cache:!1,contentType:!1,processData:!1,success:function(e){e=jQuery.trim(e);try{if(e=jQuery.parseJSON(e),"true"==e.status){var t=[];t.push(e.ticket_id),jQuery(".wpsc_admin_ticket_tab").each(function(){t.push(jQuery(this).closest("li").attr("data-id"))});var a=t.join();setCookie("wpsc_open_tickets",a,30),setCookie("wpsc_active_ticket",e.ticket_id,30),document.location.href=wpsc_localize_admin.wpsc_admin_url+"?page=wp-support-centre"}else console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide")}catch(c){console.log(c),jQuery("#wpsc_processing").modal("hide")}}})}}),jQuery(document).on("click",".wpsc_delete_attachment",function(){var e=confirm("Are you sure you wish to delete this file?");if(1==e){var t=jQuery(this).attr("data-id"),a=jQuery(this).attr("data-ticket-id"),c=jQuery(this).parents("tr"),r={action:"wpsc_delete_attachment",attachment_id:t};jQuery("#wpsc_processing").modal("show"),jQuery.post(wpsc_localize_admin.wpsc_ajax_url,r,function(e){e=jQuery.trim(e);try{if(e=jQuery.parseJSON(e),"true"==e.status){var t=jQuery("#wpsc_admin_attachments_table_"+a).DataTable();t.row(c).remove().draw(),jQuery("#wpsc_processing").modal("hide")}else console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide")}catch(r){console.log(r),jQuery("#wpsc_processing").modal("hide")}})}}),jQuery(document).on("click",".wpsc_admin_thread_include_all",function(){var e=jQuery(this).attr("data-id");jQuery(this).is(":checked")?jQuery(".wpsc_admin_thread_include_"+e).prop("checked",!0):jQuery(".wpsc_admin_thread_include_"+e).prop("checked",!1)}),jQuery(document).on("click",".wpsc_ticket_save_changes_button",function(e){e.preventDefault();var t=jQuery(this).attr("data-id");if(jQuery(this).hasClass("wpsc_ticket_save_changes_notify"))var a="true";else var a="false";if(jQuery(this).hasClass("wpsc_close"))var c=!0;else var c=!1;var r=jQuery("#wpsc_admin_new_thread_status_"+t).val();if(""==r)return jQuery("#wpsc_admin_new_thread_status_"+t).addClass("wpsc_field_error"),!1;var s=jQuery("#wpsc_admin_new_thread_category_"+t).val();if(""==s)return jQuery("#wpsc_admin_new_thread_category_"+t).addClass("wpsc_field_error"),!1;var i=jQuery("#wpsc_admin_new_thread_agent_"+t).val();if(""==i)return jQuery("#wpsc_admin_new_thread_agent_"+t).addClass("wpsc_field_error"),!1;var _=jQuery("#wpsc_admin_new_thread_priority_"+t).val();if(""==_)return jQuery("#wpsc_admin_new_thread_priority_"+t).addClass("wpsc_field_error"),!1;var n=jQuery("#wpsc_admin_new_thread_client_phone_"+t).val();if(jQuery("#wpsc_admin_ticket_subject_"+t).length){var o=jQuery("#wpsc_admin_ticket_subject_"+t).val();if(""==o)return jQuery("#wpsc_admin_ticket_subject_"+t).addClass("wpsc_field_error"),!1}else var o="";jQuery(".wpsc_additional_field_required").each(function(){var e=jQuery(this).attr("data-ticket-id");return!isNaN(e)&&e==t&&jQuery(this).is(":visible")&&""==jQuery(this).val()?(jQuery(this).addClass("wpsc_field_error"),!1):void 0});var l=0,u=[];if(jQuery(".wpsc_additional_field").length){jQuery(".wpsc_additional_field").each(function(){if(jQuery(this).is(":visible")){var e=jQuery(this).attr("data-ticket-id");if(!isNaN(e)&&e==t){var a="_"+t,c=jQuery(this).attr("id"),c=c.replace(a,"");u[l]={},u[l].field_id=c,u[l].meta_value=jQuery(this).val(),l+=1}}});var p=JSON.stringify(u)}var d={action:"wpsc_ticket_save_changes",wpsc_notify:a,wpsc_ticket_id:t,wpsc_admin_new_thread_status:r,wpsc_admin_new_thread_category:s,wpsc_admin_new_thread_agent:i,wpsc_admin_new_thread_priority:_,wpsc_admin_new_thread_client_phone:n,wpsc_ticket_subject:o,wpsc_additional_field:p};jQuery("#wpsc_processing").modal("show"),jQuery.post(wpsc_localize_admin.wpsc_ajax_url,d,function(e){e=jQuery.trim(e);try{if(e=jQuery.parseJSON(e),"true"==e.status)if(jQuery("#wpsc_processing").modal("hide"),doRefreshAdminTicketsTable(),c){doRefreshAdminTicketsTable(),jQuery('a[href="#wpsc_view_ticket_'+t+'"]').closest("li").remove(),jQuery("#wpsc_view_ticket_"+t).remove();var a=[];jQuery(".wpsc_admin_ticket_tab").each(function(){a.push(jQuery(this).closest("li").attr("data-id"))});var r=a.join();setCookie("wpsc_open_tickets",r,30),setCookie("wpsc_active_ticket","",30),jQuery("#wpsc_admin_tabs a:first").tab("show"),jQuery("#wpsc_processing").modal("hide")}else jQuery("#wpsc_ticket_changes_saved").modal("show");else console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide")}catch(s){console.log(s),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".wpsc_ticket_new_thread_button",function(e){e.preventDefault();var t=!0,a=jQuery(this).attr("data-id"),c=jQuery(this).attr("id");if(c.indexOf("wpsc_new_note")>-1)var r="false";else if(c.indexOf("wpsc_new_thread")>-1)var r="true";if(jQuery(this).hasClass("wpsc_close"))var s=!0;else var s=!1;var i=new FormData;i.append("action","wpsc_new_note"),i.append("wpsc_ticket_id",a),i.append("wpsc_notify",r);var _=jQuery("#wpsc_admin_new_thread_client_phone_"+a).val();i.append("wpsc_admin_new_thread_client_phone",_);var n=jQuery("#wpsc_admin_new_thread_status_"+a).val();if(""==n)return jQuery("#wpsc_admin_new_thread_status_"+a).addClass("wpsc_field_error"),t=!1,!1;i.append("wpsc_admin_new_thread_status",n);var o=jQuery("#wpsc_admin_new_thread_category_"+a).val();if(""==o)return jQuery("#wpsc_admin_new_thread_category_"+a).addClass("wpsc_field_error"),t=!1,!1;i.append("wpsc_admin_new_thread_category",o);var l=jQuery("#wpsc_admin_new_thread_agent_"+a).val();if(""==l)return jQuery("#wpsc_admin_new_thread_agent_"+a).addClass("wpsc_field_error"),t=!1,!1;i.append("wpsc_admin_new_thread_agent",l);var u=jQuery("#wpsc_admin_new_thread_priority_"+a).val();if(""==u)return jQuery("#wpsc_admin_new_thread_priority_"+a).addClass("wpsc_field_error"),t=!1,!1;i.append("wpsc_admin_new_thread_priority",u),CKEDITOR.instances["wpsc_admin_ticket_note_"+a].updateElement();var p=CKEDITOR.instances["wpsc_admin_ticket_note_"+a].getData();if(""==p)return alert("Thread content cannot be empty."),t=!1,!1;if(i.append("wpsc_admin_ticket_note",p),jQuery("#wpsc_admin_ticket_subject_"+a).length){var d=jQuery("#wpsc_admin_ticket_subject_"+a).val();if(""==d)return jQuery("#wpsc_admin_ticket_subject_"+a).addClass("wpsc_field_error"),t=!1,!1}else var d="";i.append("wpsc_ticket_subject",d);var w=jQuery("#wpsc_admin_existing_thread_attachments_"+a).val();w=jQuery.isArray(w)?w.join(","):"",i.append("wpsc_admin_existing_thread_attachments",w);var y=jQuery("input[name=wpsc_admin_thread_create_as_"+a+"]:checked").val();if(i.append("wpsc_admin_thread_create_as",y),"other"==y){var h=jQuery("#wpsc_admin_new_thread_from_name_"+a).val();if(""==h)return jQuery("#wpsc_admin_new_thread_from_name_"+a).addClass("wpsc_field_error"),t=!1,!1;var j=jQuery("#wpsc_admin_new_thread_from_email_"+a).val();if(""==j)return jQuery("#wpsc_admin_new_thread_from_email_"+a).addClass("wpsc_field_error"),t=!1,!1}else if("client"==y)var h=jQuery("#wpsc_admin_new_thread_client_"+a).val(),j=jQuery("#wpsc_admin_new_thread_client_email_"+a).val();else var h=jQuery("#wpsc_admin_new_thread_agent_name_"+a).val(),j=jQuery("#wpsc_admin_new_thread_agent_email_"+a).val();if(i.append("wpsc_admin_thread_from_name",h),i.append("wpsc_admin_thread_from_email",j),c.indexOf("wpsc_new_thread")>-1){var m=jQuery("#wpsc_admin_new_thread_to_select_"+a).val(),Q=jQuery("#wpsc_admin_new_thread_to_"+a).val();if(""==Q&&(""==m||"0"==m))return jQuery("#wpsc_admin_new_thread_to_select_"+a).addClass("wpsc_field_error"),jQuery("#wpsc_admin_new_thread_to_"+a).addClass("wpsc_field_error"),t=!1,!1;""!=Q&&""!=m?Q=Q+","+m:""==Q&&""!=m&&(Q=m),i.append("wpsc_admin_new_thread_to",Q)}var f=jQuery("#wpsc_admin_new_thread_cc_select_"+a).val(),g=jQuery("#wpsc_admin_new_thread_cc_"+a).val();f=jQuery.isArray(f)?f.join(","):"",""!=g&&""!=f?g=g+","+f:""==g&&""!=f&&(g=f),i.append("wpsc_admin_new_thread_cc",g);var v=jQuery("#wpsc_admin_new_thread_bcc_select_"+a).val(),k=jQuery("#wpsc_admin_new_thread_bcc_"+a).val();if(v=jQuery.isArray(v)?v.join(","):"",""!=k&&""!=v?k=k+","+v:""==k&&""!=v&&(k=v),i.append("wpsc_admin_new_thread_bcc",k),jQuery("#wpsc_admin_thread_is_private_"+a).is(":checked"))var b=1;else var b=0;i.append("wpsc_admin_thread_is_private",b);var x="";jQuery(".wpsc_admin_thread_include_"+a+":checked").each(function(){x=""==x?jQuery(this).attr("data-id"):x+","+jQuery(this).attr("data-id")}),i.append("wpsc_admin_thread_inlcudes",x);var D=jQuery("#wpsc_admin_new_thread_attachments_"+a).prop("files");if(jQuery.each(D,function(e,t){i.append("wpsc_file["+e+"]",t)}),jQuery(".wpsc_additional_field_required").each(function(){var e=jQuery(this).attr("data-ticket-id");return!isNaN(e)&&e==a&&jQuery(this).is(":visible")&&""==jQuery(this).val()?(jQuery(this).addClass("wpsc_field_error"),t=!1,!1):void 0}),t===!1)return!1;var T=0,C=[];if(jQuery(".wpsc_additional_field").length){jQuery(".wpsc_additional_field").each(function(){if(jQuery(this).is(":visible")){var e=jQuery(this).attr("data-ticket-id");if(!isNaN(e)&&e==a){var t="_"+a,c=jQuery(this).attr("id"),c=c.replace(t,"");C[T]={},C[T].field_id=c,C[T].meta_value=jQuery(this).val(),T+=1}}});var O=JSON.stringify(C);i.append("wpsc_additional_field",O)}CKEDITOR.instances["wpsc_admin_ticket_note_"+a].resetDirty(),jQuery("#wpsc_processing").modal("show"),jQuery.ajax({url:wpsc_localize_admin.wpsc_ajax_url,type:"POST",data:i,async:!0,cache:!1,contentType:!1,processData:!1,success:function(e){e=jQuery.trim(e);try{if(e=jQuery.parseJSON(e),"true"==e.status)if(s){doRefreshAdminTicketsTable(),jQuery('a[href="#wpsc_view_ticket_'+a+'"]').closest("li").remove(),jQuery("#wpsc_view_ticket_"+a).remove();var t=[];jQuery(".wpsc_admin_ticket_tab").each(function(){t.push(jQuery(this).closest("li").attr("data-id"))});var c=t.join();setCookie("wpsc_open_tickets",c,30),setCookie("wpsc_active_ticket","",30),jQuery("#wpsc_admin_tabs a:first").tab("show"),jQuery("#wpsc_processing").modal("hide")}else loadAdminTicket(a,!0);else console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide")}catch(r){console.log(r),jQuery("#wpsc_processing").modal("hide")}}})}),jQuery(document).on("click",".wpsc_account_save_changes_button",function(){var e=jQuery(this).attr("data-id"),t=jQuery(this).attr("data-user-id"),a=jQuery(this).attr("data-account-id"),c=jQuery(this).attr("data-is-ticket"),r=new FormData;r.append("action","wpsc_account_save_changes"),r.append("wpsc_user_id",t),r.append("wpsc_account_id",a);var s=CKEDITOR.instances["wpsc_account_information_"+e].getData();r.append("wpsc_account_information",s),CKEDITOR.instances["wpsc_account_information_"+e].resetDirty(),jQuery("#wpsc_processing").modal("show"),jQuery.ajax({url:wpsc_localize_admin.wpsc_ajax_url,type:"POST",data:r,async:!0,cache:!1,contentType:!1,processData:!1,success:function(t){t=jQuery.trim(t);try{t=jQuery.parseJSON(t),"true"==t.status?"true"==c?loadAdminTicket(e,!0):(jQuery("#wpsc_account_tab_"+e).remove(),jQuery("#wpsc_account_"+e).remove(),jQuery("#wpsc_admin_settings_users_tabs a:first").tab("show"),jQuery("#wpsc_processing").modal("hide")):(console.log(t),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(a){console.log(a),jQuery("#wpsc_processing").modal("hide")}}})}),jQuery(document).on("click",".wpsc_admin_thread_create_as",function(){var e=jQuery(this).val(),t=jQuery(this).attr("data-id");switch(e){case"agent":jQuery(".wpsc_admin_thread_create_as_other").hide(),jQuery("#wpsc_admin_new_thread_from_name_"+t).val(""),jQuery("#wpsc_admin_new_thread_from_email_"+t).val("");var a=jQuery("#wpsc_admin_new_thread_client_email_"+t).val();jQuery("#wpsc_admin_new_thread_to_"+t).val(a),jQuery("#wpsc_admin_new_thread_cc_"+t).val(""),jQuery("#wpsc_admin_new_thread_bcc_"+t).val("");break;case"client":jQuery(".wpsc_admin_thread_create_as_other").hide(),jQuery("#wpsc_admin_new_thread_from_name_"+t).val(""),jQuery("#wpsc_admin_new_thread_from_email_"+t).val("");var a=jQuery("#wpsc_admin_new_thread_agent_email_"+t).val();jQuery("#wpsc_admin_new_thread_to_"+t).val(a),jQuery("#wpsc_admin_new_thread_cc_"+t).val(""),jQuery("#wpsc_admin_new_thread_bcc_"+t).val("");break;case"other":jQuery(".wpsc_admin_thread_create_as_other").show(),jQuery("#wpsc_admin_new_thread_from_name_"+t).val(""),jQuery("#wpsc_admin_new_thread_from_email_"+t).val("");var a=jQuery("#wpsc_admin_new_thread_agent_email_"+t).val();jQuery("#wpsc_admin_new_thread_to_"+t).val(a),jQuery("#wpsc_admin_new_thread_cc_"+t).val(""),jQuery("#wpsc_admin_new_thread_bcc_"+t).val("")}}),jQuery(".wpsc_admin_thread_include").click(function(){var e=jQuery(this).attr("data-ticket");jQuery(this).is(":checked")&&jQuery(".wpsc_admin_thread_include_"+e).length==jQuery(".wpsc_admin_thread_include_"+e+":checked").length?jQuery("#wpsc_admin_thread_include_all_"+e).prop("checked",!0):jQuery("#wpsc_admin_thread_include_all_"+e).prop("checked",!1)}),jQuery(window).on("resize",function(){var e=jQuery("#wpsc_admin_tickets_table").DataTable();e.columns.adjust().draw()}),jQuery(document).on("click","#wpsc_quick_find_button",function(){var e=jQuery("#wpsc_quick_find").val();return jQuery.isNumeric(e)?(jQuery("#wpsc_quick_find").removeClass("wpsc_field_error"),void(0==jQuery("#wpsc_view_ticket_"+e).length&&(jQuery("#wpsc_processing").modal("show"),loadAdminTicket(e,!1)))):(jQuery("#wpsc_quick_find").addClass("wpsc_field_error"),!1)}),jQuery(document).on("click","#wpsc_select_all_recurring",function(){jQuery(this).is(":checked")?(jQuery(".wpsc_select_recurring_ticket").prop("checked",!0),jQuery("#wpsc_recurring_actions").show()):(jQuery(".wpsc_select_recurring_ticket").prop("checked",!1),jQuery("#wpsc_recurring_actions").hide())}),jQuery(document).on("click",".wpsc_select_recurring_ticket",function(){jQuery(this).is(":checked")&&jQuery(".wpsc_select_recurring_ticket").length==jQuery(".wpsc_select_recurring_ticket:checked").length?jQuery("#wpsc_select_all_recurring").prop("checked",!0):jQuery("#wpsc_select_all_recurring").prop("checked",!1),0==jQuery(".wpsc_select_recurring_ticket:checked").length?jQuery("#wpsc_recurring_actions").hide():jQuery("#wpsc_recurring_actions").show()}),jQuery(document).on("click","#wpsc_admin_apply_recurring_actions",function(){var e="";jQuery(".wpsc_select_recurring_ticket:checked").each(function(){var t=jQuery(this).val();e="undefined"==e||""==e?t:e+","+t});var t=jQuery("#wpsc_recurring_action_status").val(),a=jQuery("#wpsc_recurring_action_category").val(),c=jQuery("#wpsc_recurring_action_priority").val(),r=jQuery("#wpsc_recurring_action_agent").val();if(""==t&&""==a&&""==c&&""==r)return!1;jQuery("#wpsc_processing").modal("show");var s={action:"wpsc_admin_apply_recurring_actions",theSelectedIDs:e,wpsc_recurring_action_status:t,wpsc_recurring_action_category:a,wpsc_recurring_action_priority:c,wpsc_recurring_action_agent:r};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,s,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?document.location.href=document.location.href:(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".wpsc_recurring_ticket_row td",function(){if(!1===jQuery(this).hasClass("wpsc_select_recurring_ticket_td")&&!1===jQuery(this).hasClass("wpsc_run_recurring_ticket_td")){var e=jQuery(this).closest("tr").attr("id");0==jQuery("#wpsc_view_recurring_ticket_"+e).length&&(jQuery("#wpsc_processing").modal("show"),loadRecurringTicket(e))}}),jQuery(document).on("click",".wpsc_recurring_tab_close",function(){var e=jQuery(this).closest("li").remove().attr("data-id");jQuery("#wpsc_view_recurring_ticket_"+e).remove(),jQuery("#wpsc_admin_recurring_tabs a:first").tab("show")}),jQuery(document).on("click",".wpsc_new_recurring_ticket_button",function(){var e=jQuery(this).attr("id"),t=!0;if(jQuery(".wpsc_field_error").removeClass("wpsc_field_error"),jQuery(".wpsc_new_recurring_ticket").each(function(){if(""==jQuery(this).val())"wpsc_new_recurring_ticket_client_id"==jQuery(this).attr("id")?jQuery("#wpsc_admin_client_autocomplete_recurring").addClass("wpsc_field_error"):jQuery(this).addClass("wpsc_field_error"),t=!1;else if("wpsc_admin_client_autocomplete_recurring"==jQuery(this).attr("id")){var e=jQuery(this).val();-1==e.indexOf(" ")&&(jQuery("#wpsc_admin_client_autocomplete_recurring").addClass("wpsc_field_error"),t=!1)}}),t!==!1){jQuery("#wpsc_processing").modal("show");var a=new FormData;a.append("action","wpsc_new_recurring_ticket_save"),a.append("action_type",e),jQuery(".wpsc_new_recurring_ticket").each(function(){var e=jQuery(this).attr("id"),t=jQuery(this).val();a.append(e,t)});var c=CKEDITOR.instances.wpsc_new_recurring_ticket_details.getData();a.append("wpsc_new_recurring_ticket_details",c),jQuery("#wpsc_admin_new_recurring_ticket_enable").is(":checked")?a.append("wpsc_admin_new_recurring_ticket_enable","1"):a.append("wpsc_admin_new_recurring_ticket_enable","0"),jQuery("#wpsc_admin_new_recurring_ticket_notify").is(":checked")?a.append("wpsc_admin_new_recurring_ticket_notify","1"):a.append("wpsc_admin_new_recurring_ticket_notify","0");var r=jQuery("#wpsc_admin_new_recurring_ticket_attachments").prop("files");jQuery.each(r,function(e,t){a.append("wpsc_file["+e+"]",t)}),CKEDITOR.instances.wpsc_new_recurring_ticket_details.resetDirty(),jQuery.ajax({url:wpsc_localize_admin.wpsc_ajax_url,type:"POST",data:a,async:!0,cache:!1,contentType:!1,processData:!1,success:function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?document.location.href=document.location.href:(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}}})}}),jQuery(document).on("click",".wpsc_save_recurring_ticket_button",function(){var e=jQuery(this).attr("data-id"),t=!0;if(jQuery(".wpsc_field_error").removeClass("wpsc_field_error"),jQuery(".wpsc_edit_recurring_ticket_validate").each(function(){""==jQuery(this).val()&&(jQuery(this).attr("id")=="wpsc_edit_recurring_ticket_client_id_"+e?jQuery("#wpsc_admin_client_autocomplete_recurring_"+e).addClass("wpsc_field_error"):jQuery(this).addClass("wpsc_field_error"),t=!1)}),t!==!1){jQuery("#wpsc_processing").modal("show");var a=new FormData;a.append("action","wpsc_edit_recurring_ticket_save"),a.append("ticket_id",e),jQuery(".wpsc_edit_recurring_ticket").each(function(){var e=jQuery(this).attr("id"),t=jQuery(this).val();a.append(e,t)});var c=CKEDITOR.instances["wpsc_edit_recurring_ticket_details_"+e].getData();a.append("wpsc_edit_recurring_ticket_details",c),jQuery("#wpsc_admin_edit_recurring_ticket_enable_"+e).is(":checked")?a.append("wpsc_admin_edit_recurring_ticket_enable","1"):a.append("wpsc_admin_edit_recurring_ticket_enable","0"),jQuery("#wpsc_admin_edit_recurring_ticket_notify_"+e).is(":checked")?a.append("wpsc_admin_edit_recurring_ticket_notify","1"):a.append("wpsc_admin_edit_recurring_ticket_notify","0");var r=jQuery("#wpsc_admin_edit_recurring_ticket_attachments_"+e).prop("files");jQuery.each(r,function(e,t){a.append("wpsc_file["+e+"]",t)}),a.append("wpsc_edit_recurring_ticket_attachments_existing",jQuery("#wpsc_edit_recurring_ticket_attachments_existing_"+e).val()),CKEDITOR.instances["wpsc_edit_recurring_ticket_details_"+e].resetDirty(),jQuery.ajax({url:wpsc_localize_admin.wpsc_ajax_url,type:"POST",data:a,async:!0,cache:!1,contentType:!1,processData:!1,success:function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?document.location.href=document.location.href:(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}}})}}),jQuery(document).on("click",".wpsc_delete_recurring_ticket_button",function(){jQuery("#wpsc_processing").modal("show");var e=jQuery(this).attr("data-id"),t={action:"wpsc_delete_recurring_ticket",ticket_id:e};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,t,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?document.location.href=document.location.href:(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".wpsc_recurring_ticket_delete_attachment",function(){var e=jQuery(this).attr("data-id"),t=jQuery(this).attr("data-ticket"),a=jQuery("#wpsc_edit_recurring_ticket_attachments_existing_"+t).val(),c=a.split(","),r=jQuery.inArray(e,c);r>-1&&c.splice(r,1);var s=c.join();jQuery("#wpsc_edit_recurring_ticket_attachments_existing_"+t).val(s),jQuery(this).closest("tr").remove()}),jQuery(document).on("click",".wpsc_ticket_share_button",function(){var e=jQuery(this).attr("data-id"),t=jQuery("#wpsc_ticket_shared_users_"+e).val();t=jQuery.isArray(t)?t.join(","):"";var a={action:"wpsc_ticket_shared_users",ticket_id:e,wpsc_ticket_shared_users:t};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,a,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?(jQuery("#wpsc_settings_saved").modal("show"),jQuery("#wpsc_processing").modal("hide")):(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".wpsc_wpsc_save_general",function(){var e=jQuery("#wpsc_rename"),t=jQuery("#wpsc_item"),a=jQuery("#wpsc_client"),c=jQuery("#wpsc_support_page"),r=jQuery("#wpsc_thanks_page");if(jQuery("#wpsc_file_upload").is(":checked"))var s=1;else var s=0;var i=jQuery("#wpsc_recurring_tickets_scheduled_time");if(""==e.val())return e.addClass("wpsc_field_error").focus(),!1;if(""==t.val())return t.addClass("wpsc_field_error").focus(),!1;if(""==a.val())return a.addClass("wpsc_field_error").focus(),!1;jQuery("#wpsc_processing").modal("show");var _={action:"wpsc_save_general",wpsc_rename:e.val(),wpsc_item:t.val(),wpsc_client:a.val(),wpsc_support_page:c.val(),wpsc_thanks_page:r.val(),wpsc_file_upload:s,wpsc_recurring_tickets_scheduled_time:i.val()};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,_,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?(jQuery("#wpsc_settings_saved").modal("show"),jQuery("#wpsc_processing").modal("hide")):(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".wpsc_wpsc_save_email",function(){var e=jQuery("#wpsc_email_from_name"),t=jQuery("#wpsc_email_from_email"),a=jQuery("#wpsc_email_reply_to"),c=CKEDITOR.instances.wpsc_admin_signature.getData(),r=jQuery("input[name=wpsc_email_method]:checked").val();if(1==r){var s=jQuery("#wpsc_email_piping");jQuery("#wpsc_enable_email_piping_catch_all");if(jQuery("#wpsc_use_agent_email").is(":checked"))var i=1;else var i=0;if(jQuery("#wpsc_enable_email_piping").is(":checked"))var _=1;else var _=0;if(jQuery("#wpsc_enable_email_piping_catch_all").is(":checked"))var n=1;else var n=0}else if(2==r)var o=jQuery("#wpsc_imap_server"),l=jQuery("#wpsc_imap_port"),u=jQuery("#wpsc_imap_username"),p=jQuery("#wpsc_imap_password"),d=jQuery("#wpsc_imap_type");if(""==e.val())return e.addClass("wpsc_field_error").focus(),!1;if(""==t.val())return t.addClass("wpsc_field_error").focus(),!1;if(""==a.val())return a.addClass("wpsc_field_error").focus(),!1;if(jQuery("#wpsc_processing").modal("show"),1==r)var w={action:"wpsc_save_email",wpsc_email_from_name:e.val(),wpsc_email_from_email:t.val(),wpsc_email_reply_to:a.val(),wpsc_use_agent_email:i,wpsc_admin_signature:c,wpsc_email_method:r,wpsc_enable_email_piping:_,wpsc_enable_email_piping_catch_all:n,wpsc_email_piping:s.val()};else if(2==r)var w={action:"wpsc_save_email",wpsc_email_from_name:e.val(),
wpsc_email_from_email:t.val(),wpsc_email_reply_to:a.val(),wpsc_use_agent_email:i,wpsc_admin_signature:c,wpsc_email_method:r,wpsc_imap_server:o.val(),wpsc_imap_port:l.val(),wpsc_imap_username:u.val(),wpsc_imap_password:p.val(),wpsc_imap_type:d.val()};else var w={action:"wpsc_save_email",wpsc_email_from_name:e.val(),wpsc_email_from_email:t.val(),wpsc_email_reply_to:a.val(),wpsc_use_agent_email:i,wpsc_admin_signature:c,wpsc_email_method:r};CKEDITOR.instances.wpsc_admin_signature.resetDirty(),jQuery.post(wpsc_localize_admin.wpsc_ajax_url,w,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?(jQuery("#wpsc_settings_saved").modal("show"),jQuery("#wpsc_processing").modal("hide")):(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".wpsc_save_wpsc_agent",function(){jQuery("#wpsc_processing").modal("show");var e=jQuery("#wpsc_agent_default");if(""==e.val())return e.addClass("wpsc_field_error").focus(),!1;var t=[],a=[],c=[],r=[];if(0==jQuery(".wpsc_user_agent:checked").length||0==jQuery(".wpsc_user_supervisor:checked").length)return alert("You must assign at least one agent and one supervisor."),!1;jQuery(".wpsc_user_agent").each(function(){jQuery(this).is(":checked")?t.push(jQuery(this).attr("data-id")):c.push(jQuery(this).attr("data-id"))}),jQuery(".wpsc_user_supervisor").each(function(){jQuery(this).is(":checked")?a.push(jQuery(this).attr("data-id")):r.push(jQuery(this).attr("data-id"))});var s=t.join(),i=a.join(),_=c.join(),n=r.join(),o={action:"wpsc_save_agent_settings",wpsc_agent_default:e.val(),wpsc_agents:s,wpsc_supers:i,wpsc_agents_remove:_,wpsc_supers_remove:n};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,o,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?document.location.href=document.location.href:(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".wpsc_save_status_colour",function(){jQuery("#wpsc_processing").modal("show"),jQuery(this).hide();var e=jQuery(this),t=e.attr("data-id"),a=jQuery("#wpsc_status_"+t).val(),c=jQuery("#wpsc_prefix_"+t).val(),r=jQuery("#status_colour_"+t).val(),s={action:"wpsc_save_status_colour",wpsc_id:t,wpsc_status:a,wpsc_prefix:c,wpsc_colour:r};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,s,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?(jQuery("#wpsc_settings_saved").modal("show"),jQuery("#wpsc_processing").modal("hide")):(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".wpsc_status_default",function(){jQuery("#wpsc_processing").modal("show");var e=jQuery(this),t=e.val(),a={action:"wpsc_status_default",wpsc_id:t};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,a,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?(jQuery("#wpsc_settings_saved").modal("show"),jQuery("#wpsc_processing").modal("hide")):(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".wpsc_delete_status",function(){jQuery("#wpsc_processing").modal("show");var e=jQuery(this),t=e.attr("data-id"),a={action:"wpsc_delete_status",wpsc_id:t};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,a,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?document.location.href=document.location.href:(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".wpsc_delete_imap",function(){jQuery("#wpsc_processing").modal("show");var e=jQuery(this),t=e.attr("data-id"),a={action:"wpsc_delete_imap",imap_id:t};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,a,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?document.location.href=document.location.href:(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".wpsc_add_new_status",function(){var e=jQuery("#wpsc_new_status"),t=jQuery("#wpsc_new_status_colour"),a=jQuery("#wpsc_new_status_subject_prefix");if(""==e.val())return e.addClass("wpsc_field_error").focus(),!1;if(""==t.val())return t.closest(".wp-picker-container").addClass("wpsc_field_error").focus(),!1;jQuery("#wpsc_processing").modal("show");var c={action:"wpsc_add_new_status",wpsc_new_status:e.val(),wpsc_new_status_subject_prefix:a.val(),wpsc_new_status_colour:t.val()};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,c,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?document.location.href=document.location.href:(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".wpsc_category_default",function(){jQuery("#wpsc_processing").modal("show");var e=jQuery(this),t=e.val(),a={action:"wpsc_category_default",wpsc_id:t};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,a,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?(jQuery("#wpsc_settings_saved").modal("show"),jQuery("#wpsc_processing").modal("hide")):(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".wpsc_delete_category",function(){jQuery("#wpsc_processing").modal("show");var e=jQuery(this),t=e.attr("data-id"),a={action:"wpsc_delete_category",wpsc_id:t};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,a,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?document.location.href=document.location.href:(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".wpsc_add_new_category",function(){var e=jQuery("#wpsc_new_category");if(""==e.val())return e.addClass("wpsc_field_error").focus(),!1;jQuery("#wpsc_processing").modal("show");var t={action:"wpsc_add_new_category",wpsc_new_category:e.val()};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,t,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?document.location.href=document.location.href:(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".wpsc_save_priority_colour",function(){jQuery("#wpsc_processing").modal("show"),jQuery(this).hide();var e=jQuery(this),t=e.attr("data-id"),a=jQuery("#wpsc_priority_"+t).val(),c=jQuery("#wpsc_sla_"+t).val(),r=jQuery("#priority_colour_"+t).val(),s={action:"wpsc_save_priority_colour",wpsc_id:t,wpsc_priority:a,wpsc_sla:c,wpsc_colour:r};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,s,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?(jQuery("#wpsc_settings_saved").modal("show"),jQuery("#wpsc_processing").modal("hide")):(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".wpsc_priority_default",function(){jQuery("#wpsc_processing").modal("show");var e=jQuery(this),t=e.val(),a={action:"wpsc_priority_default",wpsc_id:t};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,a,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?(jQuery("#wpsc_settings_saved").modal("show"),jQuery("#wpsc_processing").modal("hide")):(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".wpsc_delete_priority",function(){jQuery("#wpsc_processing").modal("show");var e=jQuery(this),t=e.attr("data-id"),a={action:"wpsc_delete_priority",wpsc_id:t};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,a,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?document.location.href=document.location.href:(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".wpsc_add_new_priority",function(){var e=jQuery("#wpsc_new_priority"),t=jQuery("#wpsc_new_priority_sla"),a=jQuery("#wpsc_new_priority_colour");if(""==e.val())return e.addClass("wpsc_field_error").focus(),!1;if(""==a.val())return a.closest(".wp-picker-container").addClass("wpsc_field_error").focus(),!1;jQuery("#wpsc_processing").modal("show");var c={action:"wpsc_add_new_priority",wpsc_new_priority:e.val(),wpsc_new_priority_sla:t.val(),wpsc_new_priority_colour:a.val()};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,c,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?document.location.href=document.location.href:(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".wpsc_wpsc_save_misc",function(){if(jQuery("#wpsc_load_bootstrap_js_f").is(":checked"))var e=1;else var e=0;if(jQuery("#wpsc_load_bootstrap_js_a").is(":checked"))var t=1;else var t=0;if(jQuery("#wpsc_load_bootstrap_css_f").is(":checked"))var a=1;else var a=0;if(jQuery("#wpsc_load_bootstrap_css_a").is(":checked"))var c=1;else var c=0;jQuery("#wpsc_processing").modal("show");var r={action:"wpsc_save_misc",wpsc_load_bootstrap_js_f:e,wpsc_load_bootstrap_js_a:t,wpsc_load_bootstrap_css_f:a,wpsc_load_bootstrap_css_a:c};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,r,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?(jQuery("#wpsc_settings_saved").modal("show"),jQuery("#wpsc_processing").modal("hide")):(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click","#wpsc_save_notifications_ticket_new",function(){var e=CKEDITOR.instances.wpsc_notification_ticket_new_client.getData(),t=CKEDITOR.instances.wpsc_notification_ticket_new_admin.getData();if(jQuery("#wpsc_notification_ticket_new_client_enable").is(":checked"))var a=1;else var a=0;if(jQuery("#wpsc_notification_ticket_new_admin_enable").is(":checked"))var c=1;else var c=0;if(""==e)return alert("Notification cannot be empty!"),!1;if(""==t)return alert("Notification cannot be empty!"),!1;jQuery("#wpsc_processing").modal("show");var r={action:"wpsc_save_notifications_ticket_new",wpsc_notification_ticket_new_client:e,wpsc_notification_ticket_new_admin:t,wpsc_notification_ticket_new_client_enable:a,wpsc_notification_ticket_new_admin_enable:c};CKEDITOR.instances.wpsc_notification_ticket_new_client.resetDirty(),CKEDITOR.instances.wpsc_notification_ticket_new_admin.resetDirty(),jQuery.post(wpsc_localize_admin.wpsc_ajax_url,r,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?(jQuery("#wpsc_settings_saved").modal("show"),jQuery("#wpsc_processing").modal("hide")):(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click","#wpsc_reset_notifications_ticket_new",function(){jQuery("#wpsc_processing").modal("show");var e={action:"wpsc_reset_notifications_ticket_new"};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,e,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?document.location.href=document.location.href:(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click","#wpsc_save_notifications_ticket_reply",function(){var e=CKEDITOR.instances.wpsc_notification_ticket_reply_client.getData(),t=CKEDITOR.instances.wpsc_notification_ticket_reply_admin.getData();if(jQuery("#wpsc_notification_ticket_reply_client_enable").is(":checked"))var a=1;else var a=0;if(jQuery("#wpsc_notification_ticket_reply_admin_enable").is(":checked"))var c=1;else var c=0;var r=jQuery(".wpsc_reply_include:checked").val();if(""==e)return alert("Notification cannot be empty!"),!1;if(""==t)return alert("Notification cannot be empty!"),!1;jQuery("#wpsc_processing").modal("show");var s={action:"wpsc_save_notifications_ticket_reply",wpsc_notification_ticket_reply_client:e,wpsc_notification_ticket_reply_admin:t,wpsc_notification_ticket_reply_client_enable:a,wpsc_notification_ticket_reply_admin_enable:c,wpsc_reply_include:r};CKEDITOR.instances.wpsc_notification_ticket_reply_client.resetDirty(),CKEDITOR.instances.wpsc_notification_ticket_reply_admin.resetDirty(),jQuery.post(wpsc_localize_admin.wpsc_ajax_url,s,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?(jQuery("#wpsc_settings_saved").modal("show"),jQuery("#wpsc_processing").modal("hide")):(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click","#wpsc_reset_notifications_ticket_reply",function(){jQuery("#wpsc_processing").modal("show");var e={action:"wpsc_reset_notifications_ticket_reply"};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,e,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?document.location.href=document.location.href:(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click","#wpsc_save_notifications_ticket_change",function(){var e=CKEDITOR.instances.wpsc_notification_ticket_change_client.getData(),t=CKEDITOR.instances.wpsc_notification_ticket_change_admin.getData();if(jQuery("#wpsc_notification_ticket_change_client_enable").is(":checked"))var a=1;else var a=0;if(jQuery("#wpsc_notification_ticket_change_admin_enable").is(":checked"))var c=1;else var c=0;if(""==e)return alert("Notification cannot be empty!"),!1;if(""==t)return alert("Notification cannot be empty!"),!1;jQuery("#wpsc_processing").modal("show");var r={action:"wpsc_save_notifications_ticket_change",wpsc_notification_ticket_change_client:e,wpsc_notification_ticket_change_admin:t,wpsc_notification_ticket_change_client_enable:a,wpsc_notification_ticket_change_admin_enable:c};CKEDITOR.instances.wpsc_notification_ticket_change_client.resetDirty(),CKEDITOR.instances.wpsc_notification_ticket_change_admin.resetDirty(),jQuery.post(wpsc_localize_admin.wpsc_ajax_url,r,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?(jQuery("#wpsc_settings_saved").modal("show"),jQuery("#wpsc_processing").modal("hide")):(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click","#wpsc_reset_notifications_ticket_change",function(){jQuery("#wpsc_processing").modal("show");var e={action:"wpsc_reset_notifications_ticket_change"};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,e,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?document.location.href=document.location.href:(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".wpsc_template_row",function(){var e=jQuery(this).attr("id");jQuery("#wpsc_processing").modal("show");var t={action:"wpsc_get_template_for_edit",template_id:e};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,t,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?(jQuery("#wpsc_template_body").html(e.template),jQuery("#wpsc_edit_template").ckeditor({height:280,removeButtons:"wpsctemplates"}),jQuery("#wpsc_processing").modal("hide")):(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click","#wpsc_save_edit_template",function(){var e=jQuery(this).attr("data-id"),t=jQuery("#wpsc_edit_template_label").val();if(""==t)return jQuery("#wpsc_edit_template_label").addClass("wpsc_field_error").focus(),!1;var a=CKEDITOR.instances.wpsc_edit_template.getData();if(""==a)return alert("Template cannot be empty!"),!1;jQuery("#wpsc_processing").modal("show");var c={action:"wpsc_save_template_changes",template_id:e,wpsc_template_label_edit:t,wpsc_edit_template:a};CKEDITOR.instances.wpsc_edit_template.resetDirty(),jQuery.post(wpsc_localize_admin.wpsc_ajax_url,c,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?document.location.href=document.location.href:(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click",".wpsc_template_delete",function(){var e=confirm("Are you sure you want to delete this reply template?");if(1==e){var t=jQuery(this).attr("data-id");jQuery("#wpsc_processing").modal("show");var a={action:"wpsc_delete_template",template_id:t};jQuery.post(wpsc_localize_tickets.wpsc_ajax_url,a,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?document.location.href=document.location.href:(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}}),jQuery(document).on("click","#wpsc_select_all_templates",function(){jQuery(this).is(":checked")?(jQuery(".wpsc_select_template").prop("checked",!0),jQuery("#wpsc_template_actions").show()):(jQuery(".wpsc_select_template").prop("checked",!1),jQuery("#wpsc_template_actions").hide())}),jQuery(document).on("click",".wpsc_select_template",function(){jQuery(this).is(":checked")&&jQuery(".wpsc_select_template").length==jQuery(".wpsc_select_template:checked").length?jQuery("#wpsc_select_all_templates").prop("checked",!0):jQuery("#wpsc_select_all_templates").prop("checked",!1),0==jQuery(".wpsc_select_template:checked").length?jQuery("#wpsc_template_actions").hide():jQuery("#wpsc_template_actions").show()}),jQuery(document).on("click","#wpsc_delete_selected_templates",function(){var e="";jQuery(".wpsc_select_template").each(function(){jQuery(this).is(":checked")&&(e=""==e?jQuery(this).val():e+","+jQuery(this).val())}),jQuery("#wpsc_processing").modal("show");var t={action:"wpsc_delete_selected_templates",theIDs:e};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,t,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?document.location.href=document.location.href:(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click","#wpsc_save_new_template",function(){var e=jQuery("#wpsc_new_template_label").val();if(""==e)return jQuery("#wpsc_new_template_label").addClass("wpsc_field_error").focus(),!1;var t=CKEDITOR.instances.wpsc_new_template.getData();if(""==t)return alert("Template cannot be empty!"),!1;jQuery("#wpsc_processing").modal("show");var a={action:"wpsc_save_new_template",wpsc_template_label:e,wpsc_template:t};CKEDITOR.instances.wpsc_new_template.resetDirty(),jQuery.post(wpsc_localize_admin.wpsc_ajax_url,a,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?document.location.href=document.location.href:(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click","#wpsc_front_search",function(){jQuery("#wpsc_processing").modal("show")}),jQuery(document).on("click","#wpsc_front_clear_search",function(){jQuery("#wpsc_processing").modal("show"),document.location.href=document.location.href}),jQuery(document).on("click",".wpsc_front_ticket_row td",function(){if(!1===jQuery(this).hasClass("wpsc_select_ticket_td")){var e=jQuery(this).closest("tr").attr("id");0==jQuery("#wpsc_front_ticket_"+e).length&&(jQuery("#wpsc_processing").modal("show"),loadFrontTicket(e))}}),jQuery(document).on("click",".wpsc_front_tab_close",function(){var e=jQuery("#wpsc_wrap").attr("data-id"),t=jQuery(this).closest("li").remove().attr("data-id");jQuery("#wpsc_front_ticket_"+t).remove();var a=[];jQuery(".wpsc_front_ticket_tab").each(function(){a.push(jQuery(this).closest("li").attr("data-id"))});var c=a.join();setCookie("wpsc_open_tickets_"+e,c,30),setCookie("wpsc_active_ticket_"+e,"",30),jQuery("#wpsc_front_tabs a:first").tab("show")}),jQuery(document).on("shown.bs.collapse",".collapse",function(){jQuery(this).parent().find(".glyphicon-plus").removeClass("glyphicon-plus").addClass("glyphicon-minus")}).on("hidden.bs.collapse",".collapse",function(){jQuery(this).parent().find(".glyphicon-minus").removeClass("glyphicon-minus").addClass("glyphicon-plus")}),jQuery(document).on("click",".wpsc_front_new_thread_button",function(){var e=jQuery("#wpsc_wrap").attr("data-id"),t=jQuery(this).attr("data-id"),a=new FormData;a.append("action","wpsc_client_reply"),a.append("wpsc_ticket_id",t),a.append("wpsc_uid",e);var c=jQuery("#wpsc_front_new_thread_priority_"+t).val();if(""==c)return jQuery("#wpsc_front_new_thread_priority_"+t).addClass("wpsc_field_error"),!1;a.append("wpsc_front_new_thread_priority",c);var r=CKEDITOR.instances["wpsc_front_ticket_note_"+t].getData();if(""==r)return alert("Reply content cannot be empty."),!1;a.append("wpsc_front_ticket_note",r);var s=jQuery("#wpsc_front_new_thread_to_"+t).val();a.append("wpsc_front_new_thread_to",s);var i=jQuery("#wpsc_front_new_thread_cc_"+t).val();a.append("wpsc_front_new_thread_cc",i);var _=jQuery("#wpsc_front_new_thread_bcc_"+t).val();a.append("wpsc_front_new_thread_bcc",_);var n=jQuery("#wpsc_front_new_thread_attachments_"+t).prop("files");jQuery.each(n,function(e,t){a.append("wpsc_file["+e+"]",t)}),CKEDITOR.instances["wpsc_front_ticket_note_"+t].resetDirty(),jQuery("#wpsc_processing").modal("show"),jQuery.ajax({url:wpsc_localize_admin.wpsc_ajax_url,type:"POST",data:a,async:!0,cache:!1,contentType:!1,processData:!1,success:function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?loadFrontTicket(t):(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(a){console.log(a),jQuery("#wpsc_processing").modal("hide")}}})}),jQuery(document).on("click",".wpsc_front_new_ticket_button",function(){var e=!0;jQuery("#wpsc_wrap").attr("data-id");if(jQuery(".wpsc_field_error").removeClass("wpsc_field_error"),jQuery(".wpsc_front_new_ticket_validate").each(function(){""==jQuery(this).val()&&(jQuery(this).addClass("wpsc_field_error"),e=!1)}),jQuery(".wpsc_additional_field_required").each(function(){var t=jQuery(this).attr("data-ticket-id");(isNaN(t)||""==t)&&jQuery(this).is(":visible")&&""==jQuery(this).val()&&(jQuery(this).addClass("wpsc_field_error"),e=!1)}),e!==!1){jQuery("#wpsc_processing").modal("show");var t=new FormData;t.append("action","wpsc_front_new_ticket_save"),jQuery(".wpsc_front_new_ticket").each(function(){var e=jQuery(this).attr("id"),a=jQuery(this).val();t.append(e,a)});var a=CKEDITOR.instances.wpsc_front_new_ticket_details.getData();if(t.append("wpsc_front_new_ticket_details",a),jQuery("#wpsc_front_new_ticket_attachments").length){var c=jQuery("#wpsc_front_new_ticket_attachments").prop("files");jQuery.each(c,function(e,a){t.append("wpsc_file["+e+"]",a)})}var r=0,s=[];if(jQuery(".wpsc_additional_field").length){jQuery(".wpsc_additional_field").each(function(){if(jQuery(this).is(":visible")){var e=jQuery(this).attr("data-ticket-id");(isNaN(e)||""==e)&&(s[r]={},s[r].field_id=jQuery(this).attr("id"),s[r].meta_value=jQuery(this).val(),r+=1)}});var i=JSON.stringify(s);t.append("wpsc_additional_field",i)}CKEDITOR.instances.wpsc_front_new_ticket_details.resetDirty(),jQuery.ajax({url:wpsc_localize_admin.wpsc_ajax_url,type:"POST",data:t,async:!0,cache:!1,contentType:!1,processData:!1,success:function(e){e=jQuery.trim(e);try{if(e=jQuery.parseJSON(e),"true"==e.status){var t=e.uid,a=[];a.push(e.ticket_id),jQuery(".wpsc_front_ticket_tab").each(function(){a.push(jQuery(this).closest("li").attr("data-id"))});var c=a.join();if(setCookie("wpsc_open_tickets_"+t,c,30),"true"!=e.new_user?setCookie("wpsc_active_ticket_"+t,e.ticket_id,30):setCookie("wpsc_active_ticket_"+t,"",30),"0"!=wpsc_localize_admin.wpsc_thanks_page)document.location.href=wpsc_localize_admin.wpsc_thanks_page;else{var r="";r=r+"<p><strong>Congratulations! "+wpsc_localize_admin.wpsc_item+" #"+e.ticket_id+" has been created!</strong></p>","true"==e.new_user?r=r+"<p>As part of the creation of this "+wpsc_localize_admin.wpsc_item+" you have been registered as a new user.  Please check your email for your registration activation email and follow the instructions to complete your registration.</p>":0==jQuery("#wpsc_wrap").attr("data-id")&&(r=r+'<p>Please <a href="'+wpsc_localize_admin.wpsc_login_url+'">log in</a> to view your ticket.</p>'),jQuery("#wpsc_front_new_ticket_created_body").html(r),jQuery("#wpsc_front_new_ticket_created_dialog").modal("show"),jQuery("#wpsc_processing").modal("hide")}}else console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide")}catch(s){console.log(s),jQuery("#wpsc_processing").modal("hide")}}})}}),jQuery("#wpsc_front_new_ticket_created_dialog").on("hidden.bs.modal",function(){jQuery("#wpsc_processing").modal("show"),document.location.href=document.location.href}),jQuery(document).on("click",".email_row",function(){jQuery("#wpsc_processing").modal("show");var e=jQuery(this).attr("data-id"),t=jQuery(this).attr("data-account"),a={action:"wpsc_get_email_preview",email_id:e,account:t,cit_debug:"false"};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,a,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?(jQuery("#wpsc_processing").modal("hide"),jQuery("#wpsc_email_preview_modal").length&&jQuery("#wpsc_email_preview_modal").each(function(){jQuery(this).remove()}),jQuery(e.modal).appendTo("body"),jQuery("#wpsc_email_preview_modal").modal("show"),jQuery("#wpsc_email_preview_modal .modal-dialog").css({width:.8*jQuery(window).width(),height:.8*jQuery(window).height(),overflow:"auto"}),jQuery("#wpsc_email_preview_modal iframe").css({width:"100%",height:.45*jQuery("#wpsc_email_preview_modal .modal-dialog").height()})):(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}),jQuery(document).on("click","#wpsc_piping_new_thread",function(){if(jQuery("#wpsc_open_tickets").is(":visible")){jQuery("#wpsc_email_preview_modal").modal("hide"),jQuery("#wpsc_processing").modal("show");var e=jQuery(this).attr("data-uid"),t=jQuery(this).attr("data-accountid"),a=jQuery("#wpsc_open_tickets").val(),c={action:"wpsc_add_email_to_ticket",uid:e,account_id:t,ticket_id:a};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,c,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"==e.status?(jQuery("#wpsc_processing").modal("hide"),jQuery("#wpsc_add_email_to_ticket_dialog").modal("show")):(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}else jQuery("#wpsc_open_tickets").show()}),jQuery(document).on("click","#wpsc_piping_new_ticket",function(){jQuery("#wpsc_email_preview_modal").modal("hide"),jQuery("#wpsc_processing").modal("show");var e=jQuery(this).attr("data-uid"),t=jQuery(this).attr("data-accountid");jQuery(this).attr("data-id");document.location.href=wpsc_localize_admin.wpsc_admin_url+"?page=wp-support-centre&uid="+e+"&account_id="+t}),jQuery(document).on("click",".wpsc_pinned_thread",function(){var e=jQuery(this).attr("data-id"),t=jQuery(this).closest(".wpsc_thread_panel_group").attr("data-id"),a=jQuery(".wpsc_thread_"+e);jQuery(this).attr("data-count");if(theSlot=0,putThread=0,jQuery(this).hasClass("glyphicon-star-empty")){jQuery(this).removeClass("glyphicon-star-empty wpsc_unpinned_thread_"+t).addClass("glyphicon-star wpsc_pinned_thread_"+t),jQuery(this).closest(".panel-heading").addClass("wpsc_thread_is_pinned"),jQuery(this).closest(".wpsc_ticket_thread_"+t).removeClass("wpsc_unpinned_thread_panel_"+t).addClass("wpsc_pinned_thread_panel_"+t);var c=jQuery(".wpsc_pinned_thread_"+t).length;if(1==c)jQuery(a).insertBefore(jQuery(".wpsc_ticket_thread_"+t+":first"));else{var r=jQuery(".wpsc_pinned_thread_panel_"+t);r.sort(function(e,t){var a=parseInt(jQuery(e).attr("data-count")),c=parseInt(jQuery(t).attr("data-count"));return c>a?-1:a>c?1:0}),jQuery(r).prependTo("#wpsc_admin_ticket_threads_"+t)}var s={action:"wpsc_pinned_thread",thread_id:e,val:1};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,s,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"!=e.status&&(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}else{jQuery(this).removeClass("glyphicon-star wpsc_pinned_thread_"+t).addClass("glyphicon-star-empty wpsc_unpinned_thread_"+t),jQuery(this).closest(".panel-heading").removeClass("wpsc_thread_is_pinned"),jQuery(this).closest(".wpsc_ticket_thread_"+t).removeClass("wpsc_pinned_thread_panel_"+t).addClass("wpsc_unpinned_thread_panel_"+t);var r=jQuery(".wpsc_unpinned_thread_panel_"+t);r.sort(function(e,t){var a=parseInt(jQuery(e).attr("data-count")),c=parseInt(jQuery(t).attr("data-count"));return c>a?-1:a>c?1:0});var c=jQuery(".wpsc_pinned_thread_"+t).length;0==c?jQuery(r).prependTo("#wpsc_admin_ticket_threads_"+t):jQuery(r).insertAfter(".wpsc_pinned_thread_panel_"+t+":last");var s={action:"wpsc_pinned_thread",thread_id:e,val:0};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,s,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e),"true"!=e.status&&(console.log(e),jQuery("#wpsc_ajax_error").modal("show"),jQuery("#wpsc_processing").modal("hide"))}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})}}),jQuery("#wpsc_templates_dialog").on("shown.bs.modal",function(e){if(jQuery.fn.dataTable.isDataTable("#wpsc_admin_templates_select_table"))var t=jQuery("#wpsc_admin_templates_select_table").DataTable();else{var t=jQuery("#wpsc_admin_templates_select_table").DataTable();jQuery("#wpsc_admin_templates_select_table tfoot th").each(function(){var e=jQuery(this).text();""!=e&&jQuery(this).html('<input type="text" placeholder="Search '+e+'" class="wpsc_datatables_search" />')}),t.columns().every(function(){var e=this;jQuery("input",this.footer()).on("keyup change",function(){e.search()!==this.value&&e.search(this.value).draw()})})}}),jQuery("#wpsc_notification_shortcodes").on("shown.bs.modal",function(e){if(jQuery.fn.dataTable.isDataTable("#wpsc_notification_shortcodes_table"))var t=jQuery("#wpsc_notification_shortcodes_table").DataTable();else{var t=jQuery("#wpsc_notification_shortcodes_table").DataTable();jQuery("#wpsc_notification_shortcodes_table tfoot th").each(function(){var e=jQuery(this).text();""!=e&&jQuery(this).html('<input type="text" placeholder="Search '+e+'" class="wpsc_datatables_search" />')}),t.columns().every(function(){var e=this;jQuery("input",this.footer()).on("keyup change",function(){
e.search()!==this.value&&e.search(this.value).draw()})})}}),jQuery("#wpsc_signature_shortcodes").on("shown.bs.modal",function(e){var t=jQuery("#wpsc_signature_shortcodes_table").DataTable();jQuery("#wpsc_signature_shortcodes_table tfoot th").each(function(){var e=jQuery(this).text();""!=e&&jQuery(this).html('<input type="text" placeholder="Search '+e+'" class="wpsc_datatables_search" />')}),t.columns().every(function(){var e=this;jQuery("input",this.footer()).on("keyup change",function(){e.search()!==this.value&&e.search(this.value).draw()})})}),jQuery('a[data-toggle="tab"]').each(function(){var e=jQuery(this).attr("href"),t=jQuery(e).is(":visible");t&&doDataTables(e)}),jQuery(document).on("shown.bs.collapse",".wpsc_admin_ticket_thread_accordion",function(e){var t=jQuery(this).find("iframe ");if(!t.hasClass("wpsc_shown")){var a=t.attr("data-src");t.attr("src",a).addClass("wpsc_shown")}}),jQuery(document).on("shown.bs.tab",'a[data-toggle="tab"]',function(e){var t=jQuery(this).closest("ul");if("wpsc_admin_tabs"==t.attr("id")){var a=jQuery(this).closest("li");if(a.hasClass("wpsc_admin_ticket_tab")){setCookie("wpsc_active_ticket",a.attr("data-id"),30);var c=jQuery("#wp-admin-bar-wpsc-admin-bar a").html().split(" ["),r=c[0]+" ["+a.attr("data-id")+"]";jQuery("#wp-admin-bar-wpsc-admin-bar a").html(r);var s=jQuery("title").text().split(" - ");void 0!==s[1]?curTitle=s[1]:curTitle=s[0];var i="["+a.attr("data-id")+"] - "+curTitle;document.title=i}else{setCookie("wpsc_active_ticket","",30);var c=jQuery("#wp-admin-bar-wpsc-admin-bar a").html().split(" ["),r=c[0];jQuery("#wp-admin-bar-wpsc-admin-bar a").html(r);var s=jQuery("title").text().split(" - ");void 0!==s[1]?curTitle=s[1]:curTitle=s[0];var i=curTitle;document.title=i}}else if("wpsc_front_tabs"==t.attr("id")){var _=jQuery("#wpsc_wrap").attr("data-id"),a=jQuery(this).closest("li");a.hasClass("wpsc_front_ticket_tab")?setCookie("wpsc_active_ticket_"+_,a.attr("data-id"),30):setCookie("wpsc_active_ticket_"+_,"",30)}var n=jQuery(e.target).attr("href");doDataTables(n)}),jQuery(document).on("click",".no-collapsable",function(e){e.stopPropagation()}),jQuery(document).on("change",".wpsc_category_select",function(){var e=jQuery(this).val();jQuery(".wpsc-additional-fields").length&&""!=e&&jQuery(".wpsc-additional-fields").each(function(){if(jQuery(this).attr("data-category")){var t=jQuery(this).attr("data-category"),a=t.split(",");-1!=a.indexOf(e)?jQuery(this).show():jQuery(this).hide()}})}),jQuery(document).on("change",".wpsc_status_select",function(){var e=jQuery(this).val();jQuery(".wpsc-additional-fields").length&&""!=e&&jQuery(".wpsc-additional-fields").each(function(){if(jQuery(this).attr("data-status")){var t=jQuery(this).attr("data-status"),a=t.split(",");-1!=a.indexOf(e)?jQuery(this).show():jQuery(this).hide()}})}),jQuery(".wpsc_email_filter").click(function(e){e.preventDefault();var t=jQuery(this).attr("data-days");theHref=wpsc_localize_admin.wpsc_admin_url+"?page=wpsc_admin_mailbox&wpsc_mailbox_days="+t,document.location.href=theHref}),jQuery(document).on("click",".wpsc-notice .notice-dismiss",function(){var e=jQuery(".wpsc-notice").attr("data-id"),t={action:"wpsc_dismiss_notice",notice_id:e};jQuery.post(wpsc_localize_admin.wpsc_ajax_url,t,function(e){e=jQuery.trim(e);try{e=jQuery.parseJSON(e)}catch(t){console.log(t),jQuery("#wpsc_processing").modal("hide")}})})});